#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [1, 64], warpsPerCTA = [4, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [8, 1], threadsPerWarp = [64, 1], warpsPerCTA = [1, 4], order = [0, 1]}>
#linear = #ttg.linear<{register = [[0, 1], [0, 2], [0, 4], [32, 0]], lane = [[0, 8], [0, 16], [0, 32], [4, 0], [8, 0], [16, 0]], warp = [[1, 0], [2, 0]], block = []}>
#linear1 = #ttg.linear<{register = [[1, 0], [2, 0], [4, 0]], lane = [[8, 0], [16, 0], [32, 0], [0, 4], [0, 8], [0, 16]], warp = [[0, 1], [0, 2]], block = []}>
#linear2 = #ttg.linear<{register = [[0, 1], [0, 2], [0, 4], [16, 0], [32, 0], [64, 0], [128, 0], [256, 0]], lane = [[1, 0], [2, 0], [4, 0], [8, 0], [0, 8], [0, 16]], warp = [[0, 0], [0, 0]], block = []}>
#linear3 = #ttg.linear<{register = [[1, 0], [2, 0], [4, 0], [0, 16], [0, 32], [0, 64], [0, 128], [0, 256]], lane = [[0, 1], [0, 2], [0, 4], [0, 8], [8, 0], [16, 0]], warp = [[0, 0], [0, 0]], block = []}>
#loc = loc(unknown)
#loc1 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":228:0)
#loc291 = loc("/home/dewwang/triton/python/triton/language/standard.py":34:0)
#loc296 = loc("/home/dewwang/triton/python/triton/language/standard.py":177:0)
#loc300 = loc("/home/dewwang/triton/python/triton/language/standard.py":169:0)
#loc304 = loc("/home/dewwang/triton/python/triton/language/standard.py":287:0)
#loc308 = loc("/home/dewwang/triton/python/triton/language/standard.py":262:0)
#mma = #ttg.amd_mfma<{version = 4, warpsPerCTA = [4, 1], instrShape = [16, 16, 32], isTransposed = true}>
#shared = #ttg.padded_shared<[512:+16] {order = [1, 0], shape = [64, 512]}>
#shared1 = #ttg.padded_shared<[512:+16] {offset = [[0, 1], [0, 2], [0, 4], [0, 8], [0, 16], [0, 32], [4, 0], [8, 0], [16, 0], [1, 0], [2, 0], [32, 0]], block = []}>
#shared2 = #ttg.swizzled_shared<{vec = 8, perPhase = 1, maxPhase = 16, order = [0, 1]}>
#shared3 = #ttg.padded_shared<[512:+16] {offset = [[1, 0], [2, 0], [4, 0], [8, 0], [16, 0], [32, 0], [0, 4], [0, 8], [0, 16], [0, 1], [0, 2]], block = []}>
#smem = #ttg.shared_memory
#loc312 = loc("Q_nope"(#loc1))
#loc313 = loc("Q_pe"(#loc1))
#loc314 = loc("Kv_c_cache"(#loc1))
#loc315 = loc("K_pe_cache"(#loc1))
#loc316 = loc("Req_to_tokens"(#loc1))
#loc317 = loc("B_seq_len"(#loc1))
#loc318 = loc("O"(#loc1))
#loc319 = loc("sm_scale"(#loc1))
#loc320 = loc("stride_q_nope_bs"(#loc1))
#loc321 = loc("stride_q_nope_h"(#loc1))
#loc322 = loc("stride_q_pe_bs"(#loc1))
#loc323 = loc("stride_q_pe_h"(#loc1))
#loc324 = loc("stride_kv_c_bs"(#loc1))
#loc325 = loc("stride_k_pe_bs"(#loc1))
#loc326 = loc("stride_req_to_tokens_bs"(#loc1))
#loc327 = loc("stride_o_b"(#loc1))
#loc328 = loc("stride_o_h"(#loc1))
#loc329 = loc("stride_o_s"(#loc1))
#loc571 = loc("x"(#loc291))
#loc572 = loc("input"(#loc296))
#loc573 = loc("a"(#loc300))
#loc574 = loc("b"(#loc300))
#loc575 = loc("input"(#loc304))
#loc576 = loc("a"(#loc308))
#loc577 = loc("b"(#loc308))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 4 : i32, ttg.target = "hip:gfx950", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @_mla_attn_kernel_gluon(%Q_nope: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("Q_nope"(#loc1)), %Q_pe: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("Q_pe"(#loc1)), %Kv_c_cache: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("Kv_c_cache"(#loc1)), %K_pe_cache: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("K_pe_cache"(#loc1)), %Req_to_tokens: !tt.ptr<i32> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("Req_to_tokens"(#loc1)), %B_seq_len: !tt.ptr<i32> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("B_seq_len"(#loc1)), %O: !tt.ptr<bf16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("O"(#loc1)), %sm_scale: f32 loc("sm_scale"(#loc1)), %stride_q_nope_bs: i32 {tt.divisibility = 16 : i32} loc("stride_q_nope_bs"(#loc1)), %stride_q_nope_h: i32 {tt.divisibility = 16 : i32} loc("stride_q_nope_h"(#loc1)), %stride_q_pe_bs: i32 {tt.divisibility = 16 : i32} loc("stride_q_pe_bs"(#loc1)), %stride_q_pe_h: i32 {tt.divisibility = 16 : i32} loc("stride_q_pe_h"(#loc1)), %stride_kv_c_bs: i32 {tt.divisibility = 16 : i32} loc("stride_kv_c_bs"(#loc1)), %stride_k_pe_bs: i32 {tt.divisibility = 16 : i32} loc("stride_k_pe_bs"(#loc1)), %stride_req_to_tokens_bs: i32 loc("stride_req_to_tokens_bs"(#loc1)), %stride_o_b: i32 {tt.divisibility = 16 : i32} loc("stride_o_b"(#loc1)), %stride_o_h: i32 {tt.divisibility = 16 : i32} loc("stride_o_h"(#loc1)), %stride_o_s: i32 {tt.divisibility = 16 : i32} loc("stride_o_s"(#loc1))) attributes {noinline = false} {
    %cur_batch = tt.get_program_id y : i32 loc(#loc330)
    %cur_head_id = tt.get_program_id x : i32 loc(#loc331)
    %split_kv_id = tt.get_program_id z : i32 loc(#loc332)
    %cur_batch_seq_len = tt.addptr %B_seq_len, %cur_batch : !tt.ptr<i32>, i32 loc(#loc333)
    %cur_batch_seq_len_0 = tt.load %cur_batch_seq_len : !tt.ptr<i32> loc(#loc334)
    %buf_q_nope = ttg.local_alloc : () -> !ttg.memdesc<64x512xbf16, #shared, #smem, mutable> loc(#loc335)
    %buf_q_pe = ttg.local_alloc : () -> !ttg.memdesc<64x64xbf16, #shared1, #smem, mutable> loc(#loc336)
    %bufs_kv = ttg.local_alloc : () -> !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> loc(#loc337)
    %bufs_kpe = ttg.local_alloc : () -> !ttg.memdesc<2x64x32xbf16, #shared3, #smem, mutable> loc(#loc338)
    %offs_d_ckv = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc339)
    %cur_head = arith.constant 64 : i32 loc(#loc340)
    %cur_head_1 = arith.constant 64 : i32 loc(#loc340)
    %cur_head_2 = arith.extsi %cur_head_id : i32 to i64 loc(#loc340)
    %cur_head_3 = arith.extsi %cur_head_1 : i32 to i64 loc(#loc340)
    %cur_head_4 = arith.muli %cur_head_2, %cur_head_3 : i64 loc(#loc340)
    %cur_head_5 = arith.constant 2147483647 : i64 loc(#loc340)
    %cur_head_6 = arith.constant -2147483648 : i64 loc(#loc340)
    %cur_head_7 = arith.cmpi sle, %cur_head_4, %cur_head_5 : i64 loc(#loc340)
    %cur_head_8 = arith.cmpi sge, %cur_head_4, %cur_head_6 : i64 loc(#loc340)
    %cur_head_9 = arith.andi %cur_head_7, %cur_head_8 : i1 loc(#loc340)
    %cur_head_10 = arith.muli %cur_head_id, %cur_head_1 : i32 loc(#loc340)
    %cur_head_11 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc341)
    %cur_head_12 = tt.splat %cur_head_10 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_13 = arith.extsi %cur_head_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_14 = arith.extsi %cur_head_11 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_15 = arith.addi %cur_head_13, %cur_head_14 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_16 = arith.constant 2147483647 : i64 loc(#loc342)
    %cur_head_17 = arith.constant -2147483648 : i64 loc(#loc342)
    %cur_head_18 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_19 = arith.cmpi sle, %cur_head_15, %cur_head_18 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_20 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_21 = arith.cmpi sge, %cur_head_15, %cur_head_20 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_22 = arith.andi %cur_head_19, %cur_head_21 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %cur_head_23 = arith.addi %cur_head_12, %cur_head_11 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc342)
    %offs_q_nope = arith.extsi %cur_batch : i32 to i64 loc(#loc343)
    %offs_q_nope_24 = arith.extsi %stride_q_nope_bs : i32 to i64 loc(#loc343)
    %offs_q_nope_25 = arith.muli %offs_q_nope, %offs_q_nope_24 : i64 loc(#loc343)
    %offs_q_nope_26 = arith.constant 2147483647 : i64 loc(#loc343)
    %offs_q_nope_27 = arith.constant -2147483648 : i64 loc(#loc343)
    %offs_q_nope_28 = arith.cmpi sle, %offs_q_nope_25, %offs_q_nope_26 : i64 loc(#loc343)
    %offs_q_nope_29 = arith.cmpi sge, %offs_q_nope_25, %offs_q_nope_27 : i64 loc(#loc343)
    %offs_q_nope_30 = arith.andi %offs_q_nope_28, %offs_q_nope_29 : i1 loc(#loc343)
    %offs_q_nope_31 = arith.muli %cur_batch, %stride_q_nope_bs : i32 loc(#loc343)
    %offs_q_nope_32 = tt.expand_dims %cur_head_23 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc344)
    %offs_q_nope_33 = tt.splat %stride_q_nope_h : i32 -> tensor<64x1xi32, #blocked> loc(#loc345)
    %offs_q_nope_34 = arith.extsi %offs_q_nope_32 : tensor<64x1xi32, #blocked> to tensor<64x1xi64, #blocked> loc(#loc345)
    %offs_q_nope_35 = arith.extsi %offs_q_nope_33 : tensor<64x1xi32, #blocked> to tensor<64x1xi64, #blocked> loc(#loc345)
    %offs_q_nope_36 = arith.muli %offs_q_nope_34, %offs_q_nope_35 : tensor<64x1xi64, #blocked> loc(#loc345)
    %offs_q_nope_37 = arith.constant 2147483647 : i64 loc(#loc345)
    %offs_q_nope_38 = arith.constant -2147483648 : i64 loc(#loc345)
    %offs_q_nope_39 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked> loc(#loc345)
    %offs_q_nope_40 = arith.cmpi sle, %offs_q_nope_36, %offs_q_nope_39 : tensor<64x1xi64, #blocked> loc(#loc345)
    %offs_q_nope_41 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked> loc(#loc345)
    %offs_q_nope_42 = arith.cmpi sge, %offs_q_nope_36, %offs_q_nope_41 : tensor<64x1xi64, #blocked> loc(#loc345)
    %offs_q_nope_43 = arith.andi %offs_q_nope_40, %offs_q_nope_42 : tensor<64x1xi1, #blocked> loc(#loc345)
    %offs_q_nope_44 = arith.muli %offs_q_nope_32, %offs_q_nope_33 : tensor<64x1xi32, #blocked> loc(#loc345)
    %offs_q_nope_45 = tt.splat %offs_q_nope_31 : i32 -> tensor<64x1xi32, #blocked> loc(#loc346)
    %offs_q_nope_46 = arith.extsi %offs_q_nope_45 : tensor<64x1xi32, #blocked> to tensor<64x1xi64, #blocked> loc(#loc346)
    %offs_q_nope_47 = arith.extsi %offs_q_nope_44 : tensor<64x1xi32, #blocked> to tensor<64x1xi64, #blocked> loc(#loc346)
    %offs_q_nope_48 = arith.addi %offs_q_nope_46, %offs_q_nope_47 : tensor<64x1xi64, #blocked> loc(#loc346)
    %offs_q_nope_49 = arith.constant 2147483647 : i64 loc(#loc346)
    %offs_q_nope_50 = arith.constant -2147483648 : i64 loc(#loc346)
    %offs_q_nope_51 = arith.constant dense<2147483647> : tensor<64x1xi64, #blocked> loc(#loc346)
    %offs_q_nope_52 = arith.cmpi sle, %offs_q_nope_48, %offs_q_nope_51 : tensor<64x1xi64, #blocked> loc(#loc346)
    %offs_q_nope_53 = arith.constant dense<-2147483648> : tensor<64x1xi64, #blocked> loc(#loc346)
    %offs_q_nope_54 = arith.cmpi sge, %offs_q_nope_48, %offs_q_nope_53 : tensor<64x1xi64, #blocked> loc(#loc346)
    %offs_q_nope_55 = arith.andi %offs_q_nope_52, %offs_q_nope_54 : tensor<64x1xi1, #blocked> loc(#loc346)
    %offs_q_nope_56 = arith.addi %offs_q_nope_45, %offs_q_nope_44 : tensor<64x1xi32, #blocked> loc(#loc346)
    %offs_q_nope_57 = tt.expand_dims %offs_d_ckv {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x512xi32, #blocked> loc(#loc347)
    %offs_q_nope_58 = tt.broadcast %offs_q_nope_56 : tensor<64x1xi32, #blocked> -> tensor<64x512xi32, #blocked> loc(#loc348)
    %offs_q_nope_59 = tt.broadcast %offs_q_nope_57 : tensor<1x512xi32, #blocked> -> tensor<64x512xi32, #blocked> loc(#loc348)
    %offs_q_nope_60 = arith.extsi %offs_q_nope_58 : tensor<64x512xi32, #blocked> to tensor<64x512xi64, #blocked> loc(#loc348)
    %offs_q_nope_61 = arith.extsi %offs_q_nope_59 : tensor<64x512xi32, #blocked> to tensor<64x512xi64, #blocked> loc(#loc348)
    %offs_q_nope_62 = arith.addi %offs_q_nope_60, %offs_q_nope_61 : tensor<64x512xi64, #blocked> loc(#loc348)
    %offs_q_nope_63 = arith.constant 2147483647 : i64 loc(#loc348)
    %offs_q_nope_64 = arith.constant -2147483648 : i64 loc(#loc348)
    %offs_q_nope_65 = arith.constant dense<2147483647> : tensor<64x512xi64, #blocked> loc(#loc348)
    %offs_q_nope_66 = arith.cmpi sle, %offs_q_nope_62, %offs_q_nope_65 : tensor<64x512xi64, #blocked> loc(#loc348)
    %offs_q_nope_67 = arith.constant dense<-2147483648> : tensor<64x512xi64, #blocked> loc(#loc348)
    %offs_q_nope_68 = arith.cmpi sge, %offs_q_nope_62, %offs_q_nope_67 : tensor<64x512xi64, #blocked> loc(#loc348)
    %offs_q_nope_69 = arith.andi %offs_q_nope_66, %offs_q_nope_68 : tensor<64x512xi1, #blocked> loc(#loc348)
    %offs_q_nope_70 = arith.addi %offs_q_nope_58, %offs_q_nope_59 : tensor<64x512xi32, #blocked> loc(#loc348)
    %0 = amdg.buffer_load_to_local %Q_nope[%offs_q_nope_70] into %buf_q_nope : <bf16>[tensor<64x512xi32, #blocked>]  -> <64x512xbf16, #shared, #smem, mutable> loc(#loc21)
    %1 = ttg.async_commit_group loc(#loc22)
    %offs_d_kpe = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #linear}>> loc(#loc349)
    %cur_head_qpe = arith.constant 64 : i32 loc(#loc350)
    %cur_head_qpe_71 = arith.constant 64 : i32 loc(#loc350)
    %cur_head_qpe_72 = arith.extsi %cur_head_id : i32 to i64 loc(#loc350)
    %cur_head_qpe_73 = arith.extsi %cur_head_qpe_71 : i32 to i64 loc(#loc350)
    %cur_head_qpe_74 = arith.muli %cur_head_qpe_72, %cur_head_qpe_73 : i64 loc(#loc350)
    %cur_head_qpe_75 = arith.constant 2147483647 : i64 loc(#loc350)
    %cur_head_qpe_76 = arith.constant -2147483648 : i64 loc(#loc350)
    %cur_head_qpe_77 = arith.cmpi sle, %cur_head_qpe_74, %cur_head_qpe_75 : i64 loc(#loc350)
    %cur_head_qpe_78 = arith.cmpi sge, %cur_head_qpe_74, %cur_head_qpe_76 : i64 loc(#loc350)
    %cur_head_qpe_79 = arith.andi %cur_head_qpe_77, %cur_head_qpe_78 : i1 loc(#loc350)
    %cur_head_qpe_80 = arith.muli %cur_head_id, %cur_head_qpe_71 : i32 loc(#loc350)
    %cur_head_qpe_81 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc351)
    %cur_head_qpe_82 = tt.splat %cur_head_qpe_80 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_83 = arith.extsi %cur_head_qpe_82 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_84 = arith.extsi %cur_head_qpe_81 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_85 = arith.addi %cur_head_qpe_83, %cur_head_qpe_84 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_86 = arith.constant 2147483647 : i64 loc(#loc352)
    %cur_head_qpe_87 = arith.constant -2147483648 : i64 loc(#loc352)
    %cur_head_qpe_88 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_89 = arith.cmpi sle, %cur_head_qpe_85, %cur_head_qpe_88 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_90 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_91 = arith.cmpi sge, %cur_head_qpe_85, %cur_head_qpe_90 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_92 = arith.andi %cur_head_qpe_89, %cur_head_qpe_91 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %cur_head_qpe_93 = arith.addi %cur_head_qpe_82, %cur_head_qpe_81 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear}>> loc(#loc352)
    %offs_q_pe = arith.extsi %cur_batch : i32 to i64 loc(#loc353)
    %offs_q_pe_94 = arith.extsi %stride_q_pe_bs : i32 to i64 loc(#loc353)
    %offs_q_pe_95 = arith.muli %offs_q_pe, %offs_q_pe_94 : i64 loc(#loc353)
    %offs_q_pe_96 = arith.constant 2147483647 : i64 loc(#loc353)
    %offs_q_pe_97 = arith.constant -2147483648 : i64 loc(#loc353)
    %offs_q_pe_98 = arith.cmpi sle, %offs_q_pe_95, %offs_q_pe_96 : i64 loc(#loc353)
    %offs_q_pe_99 = arith.cmpi sge, %offs_q_pe_95, %offs_q_pe_97 : i64 loc(#loc353)
    %offs_q_pe_100 = arith.andi %offs_q_pe_98, %offs_q_pe_99 : i1 loc(#loc353)
    %offs_q_pe_101 = arith.muli %cur_batch, %stride_q_pe_bs : i32 loc(#loc353)
    %offs_q_pe_102 = tt.expand_dims %cur_head_qpe_93 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear}>> -> tensor<64x1xi32, #linear> loc(#loc354)
    %offs_q_pe_103 = tt.splat %stride_q_pe_h : i32 -> tensor<64x1xi32, #linear> loc(#loc355)
    %offs_q_pe_104 = arith.extsi %offs_q_pe_102 : tensor<64x1xi32, #linear> to tensor<64x1xi64, #linear> loc(#loc355)
    %offs_q_pe_105 = arith.extsi %offs_q_pe_103 : tensor<64x1xi32, #linear> to tensor<64x1xi64, #linear> loc(#loc355)
    %offs_q_pe_106 = arith.muli %offs_q_pe_104, %offs_q_pe_105 : tensor<64x1xi64, #linear> loc(#loc355)
    %offs_q_pe_107 = arith.constant 2147483647 : i64 loc(#loc355)
    %offs_q_pe_108 = arith.constant -2147483648 : i64 loc(#loc355)
    %offs_q_pe_109 = arith.constant dense<2147483647> : tensor<64x1xi64, #linear> loc(#loc355)
    %offs_q_pe_110 = arith.cmpi sle, %offs_q_pe_106, %offs_q_pe_109 : tensor<64x1xi64, #linear> loc(#loc355)
    %offs_q_pe_111 = arith.constant dense<-2147483648> : tensor<64x1xi64, #linear> loc(#loc355)
    %offs_q_pe_112 = arith.cmpi sge, %offs_q_pe_106, %offs_q_pe_111 : tensor<64x1xi64, #linear> loc(#loc355)
    %offs_q_pe_113 = arith.andi %offs_q_pe_110, %offs_q_pe_112 : tensor<64x1xi1, #linear> loc(#loc355)
    %offs_q_pe_114 = arith.muli %offs_q_pe_102, %offs_q_pe_103 : tensor<64x1xi32, #linear> loc(#loc355)
    %offs_q_pe_115 = tt.splat %offs_q_pe_101 : i32 -> tensor<64x1xi32, #linear> loc(#loc356)
    %offs_q_pe_116 = arith.extsi %offs_q_pe_115 : tensor<64x1xi32, #linear> to tensor<64x1xi64, #linear> loc(#loc356)
    %offs_q_pe_117 = arith.extsi %offs_q_pe_114 : tensor<64x1xi32, #linear> to tensor<64x1xi64, #linear> loc(#loc356)
    %offs_q_pe_118 = arith.addi %offs_q_pe_116, %offs_q_pe_117 : tensor<64x1xi64, #linear> loc(#loc356)
    %offs_q_pe_119 = arith.constant 2147483647 : i64 loc(#loc356)
    %offs_q_pe_120 = arith.constant -2147483648 : i64 loc(#loc356)
    %offs_q_pe_121 = arith.constant dense<2147483647> : tensor<64x1xi64, #linear> loc(#loc356)
    %offs_q_pe_122 = arith.cmpi sle, %offs_q_pe_118, %offs_q_pe_121 : tensor<64x1xi64, #linear> loc(#loc356)
    %offs_q_pe_123 = arith.constant dense<-2147483648> : tensor<64x1xi64, #linear> loc(#loc356)
    %offs_q_pe_124 = arith.cmpi sge, %offs_q_pe_118, %offs_q_pe_123 : tensor<64x1xi64, #linear> loc(#loc356)
    %offs_q_pe_125 = arith.andi %offs_q_pe_122, %offs_q_pe_124 : tensor<64x1xi1, #linear> loc(#loc356)
    %offs_q_pe_126 = arith.addi %offs_q_pe_115, %offs_q_pe_114 : tensor<64x1xi32, #linear> loc(#loc356)
    %offs_q_pe_127 = tt.expand_dims %offs_d_kpe {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #linear}>> -> tensor<1x64xi32, #linear> loc(#loc357)
    %offs_q_pe_128 = tt.broadcast %offs_q_pe_126 : tensor<64x1xi32, #linear> -> tensor<64x64xi32, #linear> loc(#loc358)
    %offs_q_pe_129 = tt.broadcast %offs_q_pe_127 : tensor<1x64xi32, #linear> -> tensor<64x64xi32, #linear> loc(#loc358)
    %offs_q_pe_130 = arith.extsi %offs_q_pe_128 : tensor<64x64xi32, #linear> to tensor<64x64xi64, #linear> loc(#loc358)
    %offs_q_pe_131 = arith.extsi %offs_q_pe_129 : tensor<64x64xi32, #linear> to tensor<64x64xi64, #linear> loc(#loc358)
    %offs_q_pe_132 = arith.addi %offs_q_pe_130, %offs_q_pe_131 : tensor<64x64xi64, #linear> loc(#loc358)
    %offs_q_pe_133 = arith.constant 2147483647 : i64 loc(#loc358)
    %offs_q_pe_134 = arith.constant -2147483648 : i64 loc(#loc358)
    %offs_q_pe_135 = arith.constant dense<2147483647> : tensor<64x64xi64, #linear> loc(#loc358)
    %offs_q_pe_136 = arith.cmpi sle, %offs_q_pe_132, %offs_q_pe_135 : tensor<64x64xi64, #linear> loc(#loc358)
    %offs_q_pe_137 = arith.constant dense<-2147483648> : tensor<64x64xi64, #linear> loc(#loc358)
    %offs_q_pe_138 = arith.cmpi sge, %offs_q_pe_132, %offs_q_pe_137 : tensor<64x64xi64, #linear> loc(#loc358)
    %offs_q_pe_139 = arith.andi %offs_q_pe_136, %offs_q_pe_138 : tensor<64x64xi1, #linear> loc(#loc358)
    %offs_q_pe_140 = arith.addi %offs_q_pe_128, %offs_q_pe_129 : tensor<64x64xi32, #linear> loc(#loc358)
    %2 = amdg.buffer_load_to_local %Q_pe[%offs_q_pe_140] into %buf_q_pe : <bf16>[tensor<64x64xi32, #linear>]  -> <64x64xbf16, #shared1, #smem, mutable> loc(#loc33)
    %3 = ttg.async_commit_group loc(#loc34)
    %e_max = tt.call @triton.experimental.gluon.language._standard.zeros__Tc64T_cfp32_cSL1_MFMA_4_16_16_32_True_4_1_32_1_1__MFMASL() : () -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc359)
    %e_max_141 = arith.constant 0x7F800000 : f32 loc(#loc360)
    %e_max_142 = arith.constant 0x7F800000 : f32 loc(#loc360)
    %e_max_143 = arith.constant dense<0x7F800000> : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc360)
    %e_max_144 = arith.subf %e_max, %e_max_143 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc360)
    %e_sum = tt.call @triton.experimental.gluon.language._standard.zeros__Tc64T_cfp32_cSL1_MFMA_4_16_16_32_True_4_1_32_1_1__MFMASL() : () -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc361)
    %acc = tt.call @triton.experimental.gluon.language._standard.zeros__Tc64_c512T_cfp32_cMFMA_4_16_16_32_True_4_1_32_1_1__MFMA() : () -> tensor<64x512xf32, #mma> loc(#loc362)
    %num_iter = tt.call @triton.language.standard.cdiv__i32_c32(%cur_batch_seq_len_0) : (i32) -> i32 loc(#loc363)
    %start_n = arith.constant 0 : i32 loc(#loc364)
    %kv_page_number = arith.extsi %stride_req_to_tokens_bs : i32 to i64 loc(#loc365)
    %kv_page_number_145 = arith.extsi %cur_batch : i32 to i64 loc(#loc365)
    %kv_page_number_146 = arith.muli %kv_page_number, %kv_page_number_145 : i64 loc(#loc365)
    %kv_page_number_147 = arith.constant 2147483647 : i64 loc(#loc365)
    %kv_page_number_148 = arith.constant -2147483648 : i64 loc(#loc365)
    %kv_page_number_149 = arith.cmpi sle, %kv_page_number_146, %kv_page_number_147 : i64 loc(#loc365)
    %kv_page_number_150 = arith.cmpi sge, %kv_page_number_146, %kv_page_number_148 : i64 loc(#loc365)
    %kv_page_number_151 = arith.andi %kv_page_number_149, %kv_page_number_150 : i1 loc(#loc365)
    %kv_page_number_152 = arith.muli %stride_req_to_tokens_bs, %cur_batch : i32 loc(#loc365)
    %kv_page_number_153 = tt.addptr %Req_to_tokens, %kv_page_number_152 : !tt.ptr<i32>, i32 loc(#loc366)
    %kv_page_number_154 = arith.constant 64 : i32 loc(#loc367)
    %kv_page_number_155 = arith.constant 64 : i32 loc(#loc367)
    %kv_page_number_156 = arith.divsi %start_n, %kv_page_number_155 : i32 loc(#loc367)
    %kv_page_number_157 = tt.addptr %kv_page_number_153, %kv_page_number_156 : !tt.ptr<i32>, i32 loc(#loc368)
    %kv_page_number_158 = tt.load %kv_page_number_157 : !tt.ptr<i32> loc(#loc369)
    %4 = ttg.async_wait {num = 1 : i32} loc(#loc46)
    %q_nope = ttg.local_load %buf_q_nope : !ttg.memdesc<64x512xbf16, #shared, #smem, mutable> -> tensor<64x512xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> loc(#loc370)
    %5 = ttg.async_wait {num = 0 : i32} loc(#loc48)
    %q_pe = ttg.local_load %buf_q_pe : !ttg.memdesc<64x64xbf16, #shared1, #smem, mutable> -> tensor<64x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> loc(#loc371)
    %offs_n = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc372)
    %offs_n_159 = arith.constant dense<0> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_160 = arith.extsi %offs_n_159 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_161 = arith.extsi %offs_n : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_162 = arith.addi %offs_n_160, %offs_n_161 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_163 = arith.constant 2147483647 : i64 loc(#loc373)
    %offs_n_164 = arith.constant -2147483648 : i64 loc(#loc373)
    %offs_n_165 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_166 = arith.cmpi sle, %offs_n_162, %offs_n_165 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_167 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_168 = arith.cmpi sge, %offs_n_162, %offs_n_167 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_169 = arith.andi %offs_n_166, %offs_n_168 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %offs_n_170 = arith.addi %offs_n_159, %offs_n : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc373)
    %kv_loc = arith.constant 64 : i32 loc(#loc374)
    %kv_loc_171 = arith.constant 64 : i32 loc(#loc374)
    %kv_loc_172 = arith.extsi %kv_page_number_158 : i32 to i64 loc(#loc374)
    %kv_loc_173 = arith.extsi %kv_loc_171 : i32 to i64 loc(#loc374)
    %kv_loc_174 = arith.muli %kv_loc_172, %kv_loc_173 : i64 loc(#loc374)
    %kv_loc_175 = arith.constant 2147483647 : i64 loc(#loc374)
    %kv_loc_176 = arith.constant -2147483648 : i64 loc(#loc374)
    %kv_loc_177 = arith.cmpi sle, %kv_loc_174, %kv_loc_175 : i64 loc(#loc374)
    %kv_loc_178 = arith.cmpi sge, %kv_loc_174, %kv_loc_176 : i64 loc(#loc374)
    %kv_loc_179 = arith.andi %kv_loc_177, %kv_loc_178 : i1 loc(#loc374)
    %kv_loc_180 = arith.muli %kv_page_number_158, %kv_loc_171 : i32 loc(#loc374)
    %kv_loc_181 = arith.constant 64 : i32 loc(#loc375)
    %kv_loc_182 = arith.constant 64 : i32 loc(#loc375)
    %kv_loc_183 = arith.constant dense<64> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc375)
    %kv_loc_184 = arith.remsi %offs_n_170, %kv_loc_183 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc375)
    %kv_loc_185 = tt.splat %kv_loc_180 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_186 = arith.extsi %kv_loc_185 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_187 = arith.extsi %kv_loc_184 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_188 = arith.addi %kv_loc_186, %kv_loc_187 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_189 = arith.constant 2147483647 : i64 loc(#loc376)
    %kv_loc_190 = arith.constant -2147483648 : i64 loc(#loc376)
    %kv_loc_191 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_192 = arith.cmpi sle, %kv_loc_188, %kv_loc_191 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_193 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_194 = arith.cmpi sge, %kv_loc_188, %kv_loc_193 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_195 = arith.andi %kv_loc_192, %kv_loc_194 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %kv_loc_196 = arith.addi %kv_loc_185, %kv_loc_184 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc376)
    %offs_d_ckv_1 = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc377)
    %offs_k_c = tt.expand_dims %kv_loc_196 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc378)
    %offs_k_c_197 = tt.splat %stride_kv_c_bs : i32 -> tensor<1x32xi32, #blocked1> loc(#loc379)
    %offs_k_c_198 = arith.extsi %offs_k_c : tensor<1x32xi32, #blocked1> to tensor<1x32xi64, #blocked1> loc(#loc379)
    %offs_k_c_199 = arith.extsi %offs_k_c_197 : tensor<1x32xi32, #blocked1> to tensor<1x32xi64, #blocked1> loc(#loc379)
    %offs_k_c_200 = arith.muli %offs_k_c_198, %offs_k_c_199 : tensor<1x32xi64, #blocked1> loc(#loc379)
    %offs_k_c_201 = arith.constant 2147483647 : i64 loc(#loc379)
    %offs_k_c_202 = arith.constant -2147483648 : i64 loc(#loc379)
    %offs_k_c_203 = arith.constant dense<2147483647> : tensor<1x32xi64, #blocked1> loc(#loc379)
    %offs_k_c_204 = arith.cmpi sle, %offs_k_c_200, %offs_k_c_203 : tensor<1x32xi64, #blocked1> loc(#loc379)
    %offs_k_c_205 = arith.constant dense<-2147483648> : tensor<1x32xi64, #blocked1> loc(#loc379)
    %offs_k_c_206 = arith.cmpi sge, %offs_k_c_200, %offs_k_c_205 : tensor<1x32xi64, #blocked1> loc(#loc379)
    %offs_k_c_207 = arith.andi %offs_k_c_204, %offs_k_c_206 : tensor<1x32xi1, #blocked1> loc(#loc379)
    %offs_k_c_208 = arith.muli %offs_k_c, %offs_k_c_197 : tensor<1x32xi32, #blocked1> loc(#loc379)
    %offs_k_c_209 = tt.expand_dims %offs_d_ckv_1 {axis = 1 : i32} : tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<512x1xi32, #blocked1> loc(#loc380)
    %offs_k_c_210 = tt.broadcast %offs_k_c_208 : tensor<1x32xi32, #blocked1> -> tensor<512x32xi32, #blocked1> loc(#loc381)
    %offs_k_c_211 = tt.broadcast %offs_k_c_209 : tensor<512x1xi32, #blocked1> -> tensor<512x32xi32, #blocked1> loc(#loc381)
    %offs_k_c_212 = arith.extsi %offs_k_c_210 : tensor<512x32xi32, #blocked1> to tensor<512x32xi64, #blocked1> loc(#loc381)
    %offs_k_c_213 = arith.extsi %offs_k_c_211 : tensor<512x32xi32, #blocked1> to tensor<512x32xi64, #blocked1> loc(#loc381)
    %offs_k_c_214 = arith.addi %offs_k_c_212, %offs_k_c_213 : tensor<512x32xi64, #blocked1> loc(#loc381)
    %offs_k_c_215 = arith.constant 2147483647 : i64 loc(#loc381)
    %offs_k_c_216 = arith.constant -2147483648 : i64 loc(#loc381)
    %offs_k_c_217 = arith.constant dense<2147483647> : tensor<512x32xi64, #blocked1> loc(#loc381)
    %offs_k_c_218 = arith.cmpi sle, %offs_k_c_214, %offs_k_c_217 : tensor<512x32xi64, #blocked1> loc(#loc381)
    %offs_k_c_219 = arith.constant dense<-2147483648> : tensor<512x32xi64, #blocked1> loc(#loc381)
    %offs_k_c_220 = arith.cmpi sge, %offs_k_c_214, %offs_k_c_219 : tensor<512x32xi64, #blocked1> loc(#loc381)
    %offs_k_c_221 = arith.andi %offs_k_c_218, %offs_k_c_220 : tensor<512x32xi1, #blocked1> loc(#loc381)
    %offs_k_c_222 = arith.addi %offs_k_c_210, %offs_k_c_211 : tensor<512x32xi32, #blocked1> loc(#loc381)
    %c0_i32 = arith.constant 0 : i32 loc(#loc60)
    %6 = ttg.memdesc_index %bufs_kv[%c0_i32] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc60)
    %7 = amdg.buffer_load_to_local %Kv_c_cache[%offs_k_c_222] into %6 : <bf16>[tensor<512x32xi32, #blocked1>]  -> <512x32xbf16, #shared2, #smem, mutable> loc(#loc61)
    %8 = ttg.async_commit_group loc(#loc62)
    %offs_n_pe = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc382)
    %offs_n_pe_223 = arith.constant dense<0> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_224 = arith.extsi %offs_n_pe_223 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_225 = arith.extsi %offs_n_pe : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_226 = arith.addi %offs_n_pe_224, %offs_n_pe_225 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_227 = arith.constant 2147483647 : i64 loc(#loc383)
    %offs_n_pe_228 = arith.constant -2147483648 : i64 loc(#loc383)
    %offs_n_pe_229 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_230 = arith.cmpi sle, %offs_n_pe_226, %offs_n_pe_229 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_231 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_232 = arith.cmpi sge, %offs_n_pe_226, %offs_n_pe_231 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_233 = arith.andi %offs_n_pe_230, %offs_n_pe_232 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %offs_n_pe_234 = arith.addi %offs_n_pe_223, %offs_n_pe : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc383)
    %kv_loc_pe = arith.constant 64 : i32 loc(#loc384)
    %kv_loc_pe_235 = arith.constant 64 : i32 loc(#loc384)
    %kv_loc_pe_236 = arith.extsi %kv_page_number_158 : i32 to i64 loc(#loc384)
    %kv_loc_pe_237 = arith.extsi %kv_loc_pe_235 : i32 to i64 loc(#loc384)
    %kv_loc_pe_238 = arith.muli %kv_loc_pe_236, %kv_loc_pe_237 : i64 loc(#loc384)
    %kv_loc_pe_239 = arith.constant 2147483647 : i64 loc(#loc384)
    %kv_loc_pe_240 = arith.constant -2147483648 : i64 loc(#loc384)
    %kv_loc_pe_241 = arith.cmpi sle, %kv_loc_pe_238, %kv_loc_pe_239 : i64 loc(#loc384)
    %kv_loc_pe_242 = arith.cmpi sge, %kv_loc_pe_238, %kv_loc_pe_240 : i64 loc(#loc384)
    %kv_loc_pe_243 = arith.andi %kv_loc_pe_241, %kv_loc_pe_242 : i1 loc(#loc384)
    %kv_loc_pe_244 = arith.muli %kv_page_number_158, %kv_loc_pe_235 : i32 loc(#loc384)
    %kv_loc_pe_245 = arith.constant 64 : i32 loc(#loc385)
    %kv_loc_pe_246 = arith.constant 64 : i32 loc(#loc385)
    %kv_loc_pe_247 = arith.constant dense<64> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc385)
    %kv_loc_pe_248 = arith.remsi %offs_n_pe_234, %kv_loc_pe_247 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc385)
    %kv_loc_pe_249 = tt.splat %kv_loc_pe_244 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_250 = arith.extsi %kv_loc_pe_249 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_251 = arith.extsi %kv_loc_pe_248 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_252 = arith.addi %kv_loc_pe_250, %kv_loc_pe_251 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_253 = arith.constant 2147483647 : i64 loc(#loc386)
    %kv_loc_pe_254 = arith.constant -2147483648 : i64 loc(#loc386)
    %kv_loc_pe_255 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_256 = arith.cmpi sle, %kv_loc_pe_252, %kv_loc_pe_255 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_257 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_258 = arith.cmpi sge, %kv_loc_pe_252, %kv_loc_pe_257 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_259 = arith.andi %kv_loc_pe_256, %kv_loc_pe_258 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %kv_loc_pe_260 = arith.addi %kv_loc_pe_249, %kv_loc_pe_248 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc386)
    %offs_d_kpe_1 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>> loc(#loc387)
    %offs_k_pe = tt.expand_dims %kv_loc_pe_260 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> -> tensor<1x32xi32, #linear1> loc(#loc388)
    %offs_k_pe_261 = tt.splat %stride_k_pe_bs : i32 -> tensor<1x32xi32, #linear1> loc(#loc389)
    %offs_k_pe_262 = arith.extsi %offs_k_pe : tensor<1x32xi32, #linear1> to tensor<1x32xi64, #linear1> loc(#loc389)
    %offs_k_pe_263 = arith.extsi %offs_k_pe_261 : tensor<1x32xi32, #linear1> to tensor<1x32xi64, #linear1> loc(#loc389)
    %offs_k_pe_264 = arith.muli %offs_k_pe_262, %offs_k_pe_263 : tensor<1x32xi64, #linear1> loc(#loc389)
    %offs_k_pe_265 = arith.constant 2147483647 : i64 loc(#loc389)
    %offs_k_pe_266 = arith.constant -2147483648 : i64 loc(#loc389)
    %offs_k_pe_267 = arith.constant dense<2147483647> : tensor<1x32xi64, #linear1> loc(#loc389)
    %offs_k_pe_268 = arith.cmpi sle, %offs_k_pe_264, %offs_k_pe_267 : tensor<1x32xi64, #linear1> loc(#loc389)
    %offs_k_pe_269 = arith.constant dense<-2147483648> : tensor<1x32xi64, #linear1> loc(#loc389)
    %offs_k_pe_270 = arith.cmpi sge, %offs_k_pe_264, %offs_k_pe_269 : tensor<1x32xi64, #linear1> loc(#loc389)
    %offs_k_pe_271 = arith.andi %offs_k_pe_268, %offs_k_pe_270 : tensor<1x32xi1, #linear1> loc(#loc389)
    %offs_k_pe_272 = arith.muli %offs_k_pe, %offs_k_pe_261 : tensor<1x32xi32, #linear1> loc(#loc389)
    %offs_k_pe_273 = tt.expand_dims %offs_d_kpe_1 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>> -> tensor<64x1xi32, #linear1> loc(#loc390)
    %offs_k_pe_274 = tt.broadcast %offs_k_pe_272 : tensor<1x32xi32, #linear1> -> tensor<64x32xi32, #linear1> loc(#loc391)
    %offs_k_pe_275 = tt.broadcast %offs_k_pe_273 : tensor<64x1xi32, #linear1> -> tensor<64x32xi32, #linear1> loc(#loc391)
    %offs_k_pe_276 = arith.extsi %offs_k_pe_274 : tensor<64x32xi32, #linear1> to tensor<64x32xi64, #linear1> loc(#loc391)
    %offs_k_pe_277 = arith.extsi %offs_k_pe_275 : tensor<64x32xi32, #linear1> to tensor<64x32xi64, #linear1> loc(#loc391)
    %offs_k_pe_278 = arith.addi %offs_k_pe_276, %offs_k_pe_277 : tensor<64x32xi64, #linear1> loc(#loc391)
    %offs_k_pe_279 = arith.constant 2147483647 : i64 loc(#loc391)
    %offs_k_pe_280 = arith.constant -2147483648 : i64 loc(#loc391)
    %offs_k_pe_281 = arith.constant dense<2147483647> : tensor<64x32xi64, #linear1> loc(#loc391)
    %offs_k_pe_282 = arith.cmpi sle, %offs_k_pe_278, %offs_k_pe_281 : tensor<64x32xi64, #linear1> loc(#loc391)
    %offs_k_pe_283 = arith.constant dense<-2147483648> : tensor<64x32xi64, #linear1> loc(#loc391)
    %offs_k_pe_284 = arith.cmpi sge, %offs_k_pe_278, %offs_k_pe_283 : tensor<64x32xi64, #linear1> loc(#loc391)
    %offs_k_pe_285 = arith.andi %offs_k_pe_282, %offs_k_pe_284 : tensor<64x32xi1, #linear1> loc(#loc391)
    %offs_k_pe_286 = arith.addi %offs_k_pe_274, %offs_k_pe_275 : tensor<64x32xi32, #linear1> loc(#loc391)
    %c0_i32_287 = arith.constant 0 : i32 loc(#loc73)
    %9 = ttg.memdesc_index %bufs_kpe[%c0_i32_287] : !ttg.memdesc<2x64x32xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> loc(#loc73)
    %10 = amdg.buffer_load_to_local %K_pe_cache[%offs_k_pe_286] into %9 : <bf16>[tensor<64x32xi32, #linear1>]  -> <64x32xbf16, #shared3, #smem, mutable> loc(#loc74)
    %11 = ttg.async_commit_group loc(#loc75)
    %start_n_288 = arith.constant 32 : i32 loc(#loc392)
    %start_n_289 = arith.constant 32 : i32 loc(#loc392)
    %start_n_290 = arith.extsi %start_n : i32 to i64 loc(#loc392)
    %start_n_291 = arith.extsi %start_n_289 : i32 to i64 loc(#loc392)
    %start_n_292 = arith.addi %start_n_290, %start_n_291 : i64 loc(#loc392)
    %start_n_293 = arith.constant 2147483647 : i64 loc(#loc392)
    %start_n_294 = arith.constant -2147483648 : i64 loc(#loc392)
    %start_n_295 = arith.cmpi sle, %start_n_292, %start_n_293 : i64 loc(#loc392)
    %start_n_296 = arith.cmpi sge, %start_n_292, %start_n_294 : i64 loc(#loc392)
    %start_n_297 = arith.andi %start_n_295, %start_n_296 : i1 loc(#loc392)
    %start_n_298 = arith.addi %start_n, %start_n_289 : i32 loc(#loc392)
    %kv_page_number_299 = arith.extsi %stride_req_to_tokens_bs : i32 to i64 loc(#loc393)
    %kv_page_number_300 = arith.extsi %cur_batch : i32 to i64 loc(#loc393)
    %kv_page_number_301 = arith.muli %kv_page_number_299, %kv_page_number_300 : i64 loc(#loc393)
    %kv_page_number_302 = arith.constant 2147483647 : i64 loc(#loc393)
    %kv_page_number_303 = arith.constant -2147483648 : i64 loc(#loc393)
    %kv_page_number_304 = arith.cmpi sle, %kv_page_number_301, %kv_page_number_302 : i64 loc(#loc393)
    %kv_page_number_305 = arith.cmpi sge, %kv_page_number_301, %kv_page_number_303 : i64 loc(#loc393)
    %kv_page_number_306 = arith.andi %kv_page_number_304, %kv_page_number_305 : i1 loc(#loc393)
    %kv_page_number_307 = arith.muli %stride_req_to_tokens_bs, %cur_batch : i32 loc(#loc393)
    %kv_page_number_308 = tt.addptr %Req_to_tokens, %kv_page_number_307 : !tt.ptr<i32>, i32 loc(#loc394)
    %kv_page_number_309 = arith.constant 64 : i32 loc(#loc395)
    %kv_page_number_310 = arith.constant 64 : i32 loc(#loc395)
    %kv_page_number_311 = arith.divsi %start_n_298, %kv_page_number_310 : i32 loc(#loc395)
    %kv_page_number_312 = tt.addptr %kv_page_number_308, %kv_page_number_311 : !tt.ptr<i32>, i32 loc(#loc396)
    %kv_page_number_313 = tt.load %kv_page_number_312 : !tt.ptr<i32> loc(#loc397)
    %c3_i32 = arith.constant 3 : i32 loc(#loc82)
    %12 = arith.cmpi sgt, %num_iter, %c3_i32 : i32 loc(#loc82)
    llvm.intr.assume %12 : i1 loc(#loc83)
    %buf_idx = arith.constant 0 : i32 loc(#loc398)
    %c2_i32 = arith.constant 2 : i32 loc(#loc85)
    %c2_i32_314 = arith.constant 2 : i32 loc(#loc85)
    %13 = arith.extsi %num_iter : i32 to i64 loc(#loc85)
    %14 = arith.extsi %c2_i32_314 : i32 to i64 loc(#loc85)
    %15 = arith.subi %13, %14 : i64 loc(#loc85)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc85)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc85)
    %16 = arith.cmpi sle, %15, %c2147483647_i64 : i64 loc(#loc85)
    %17 = arith.cmpi sge, %15, %c-2147483648_i64 : i64 loc(#loc85)
    %18 = arith.andi %16, %17 : i1 loc(#loc85)
    %19 = arith.subi %num_iter, %c2_i32_314 : i32 loc(#loc85)
    %c2_i32_315 = arith.constant 2 : i32 loc(#loc85)
    %c2_i32_316 = arith.constant 2 : i32 loc(#loc85)
    %20 = arith.extsi %num_iter : i32 to i64 loc(#loc85)
    %21 = arith.extsi %c2_i32_316 : i32 to i64 loc(#loc85)
    %22 = arith.subi %20, %21 : i64 loc(#loc85)
    %c2147483647_i64_317 = arith.constant 2147483647 : i64 loc(#loc85)
    %c-2147483648_i64_318 = arith.constant -2147483648 : i64 loc(#loc85)
    %23 = arith.cmpi sle, %22, %c2147483647_i64_317 : i64 loc(#loc85)
    %24 = arith.cmpi sge, %22, %c-2147483648_i64_318 : i64 loc(#loc85)
    %25 = arith.andi %23, %24 : i1 loc(#loc85)
    %26 = arith.subi %num_iter, %c2_i32_316 : i32 loc(#loc85)
    %c0_i32_319 = arith.constant 0 : i32 loc(#loc86)
    %c1_i32 = arith.constant 1 : i32 loc(#loc86)
    %27 = arith.bitcast %c0_i32_319 : i32 to i32 loc(#loc86)
    %28 = arith.bitcast %26 : i32 to i32 loc(#loc86)
    %29 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc86)
    %30 = ub.poison : i32 loc(#loc86)
    %buf_idx_320:14 = scf.for %i = %27 to %28 step %29 iter_args(%e_max_724 = %e_max_144, %e_sum_725 = %e_sum, %acc_726 = %acc, %start_n_727 = %start_n_298, %kv_page_number_728 = %kv_page_number_313, %offs_n_729 = %offs_n_170, %kv_loc_730 = %kv_loc_196, %offs_d_ckv_1_731 = %offs_d_ckv_1, %offs_k_c_732 = %offs_k_c_222, %offs_n_pe_733 = %offs_n_pe_234, %kv_loc_pe_734 = %kv_loc_pe_260, %offs_d_kpe_1_735 = %offs_d_kpe_1, %offs_k_pe_736 = %offs_k_pe_286, %buf_idx_737 = %buf_idx) -> (tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<64x512xf32, #mma>, i32, i32, tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>>, tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>>, tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<512x32xi32, #blocked1>, tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>>, tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>>, tensor<64x32xi32, #linear1>, i32)  : i32 {
      %async_idx_738 = arith.constant 1 : i32 loc(#loc400)
      %async_idx_739 = arith.constant 1 : i32 loc(#loc400)
      %async_idx_740 = arith.extsi %buf_idx_737 : i32 to i64 loc(#loc400)
      %async_idx_741 = arith.extsi %async_idx_739 : i32 to i64 loc(#loc400)
      %async_idx_742 = arith.addi %async_idx_740, %async_idx_741 : i64 loc(#loc400)
      %async_idx_743 = arith.constant 2147483647 : i64 loc(#loc400)
      %async_idx_744 = arith.constant -2147483648 : i64 loc(#loc400)
      %async_idx_745 = arith.cmpi sle, %async_idx_742, %async_idx_743 : i64 loc(#loc400)
      %async_idx_746 = arith.cmpi sge, %async_idx_742, %async_idx_744 : i64 loc(#loc400)
      %async_idx_747 = arith.andi %async_idx_745, %async_idx_746 : i1 loc(#loc400)
      %async_idx_748 = arith.addi %buf_idx_737, %async_idx_739 : i32 loc(#loc400)
      %async_idx_749 = arith.constant 2 : i32 loc(#loc401)
      %async_idx_750 = arith.constant 2 : i32 loc(#loc401)
      %async_idx_751 = arith.remsi %async_idx_748, %async_idx_750 : i32 loc(#loc401)
      %offs_n_752 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc402)
      %offs_n_753 = tt.splat %start_n_727 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_754 = arith.extsi %offs_n_753 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_755 = arith.extsi %offs_n_752 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_756 = arith.addi %offs_n_754, %offs_n_755 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_757 = arith.constant 2147483647 : i64 loc(#loc403)
      %offs_n_758 = arith.constant -2147483648 : i64 loc(#loc403)
      %offs_n_759 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_760 = arith.cmpi sle, %offs_n_756, %offs_n_759 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_761 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_762 = arith.cmpi sge, %offs_n_756, %offs_n_761 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_763 = arith.andi %offs_n_760, %offs_n_762 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %offs_n_764 = arith.addi %offs_n_753, %offs_n_752 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc403)
      %kv_loc_765 = arith.constant 64 : i32 loc(#loc404)
      %kv_loc_766 = arith.constant 64 : i32 loc(#loc404)
      %kv_loc_767 = arith.extsi %kv_page_number_728 : i32 to i64 loc(#loc404)
      %kv_loc_768 = arith.extsi %kv_loc_766 : i32 to i64 loc(#loc404)
      %kv_loc_769 = arith.muli %kv_loc_767, %kv_loc_768 : i64 loc(#loc404)
      %kv_loc_770 = arith.constant 2147483647 : i64 loc(#loc404)
      %kv_loc_771 = arith.constant -2147483648 : i64 loc(#loc404)
      %kv_loc_772 = arith.cmpi sle, %kv_loc_769, %kv_loc_770 : i64 loc(#loc404)
      %kv_loc_773 = arith.cmpi sge, %kv_loc_769, %kv_loc_771 : i64 loc(#loc404)
      %kv_loc_774 = arith.andi %kv_loc_772, %kv_loc_773 : i1 loc(#loc404)
      %kv_loc_775 = arith.muli %kv_page_number_728, %kv_loc_766 : i32 loc(#loc404)
      %kv_loc_776 = arith.constant 64 : i32 loc(#loc405)
      %kv_loc_777 = arith.constant 64 : i32 loc(#loc405)
      %kv_loc_778 = arith.constant dense<64> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc405)
      %kv_loc_779 = arith.remsi %offs_n_764, %kv_loc_778 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc405)
      %kv_loc_780 = tt.splat %kv_loc_775 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_781 = arith.extsi %kv_loc_780 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_782 = arith.extsi %kv_loc_779 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_783 = arith.addi %kv_loc_781, %kv_loc_782 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_784 = arith.constant 2147483647 : i64 loc(#loc406)
      %kv_loc_785 = arith.constant -2147483648 : i64 loc(#loc406)
      %kv_loc_786 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_787 = arith.cmpi sle, %kv_loc_783, %kv_loc_786 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_788 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_789 = arith.cmpi sge, %kv_loc_783, %kv_loc_788 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_790 = arith.andi %kv_loc_787, %kv_loc_789 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %kv_loc_791 = arith.addi %kv_loc_780, %kv_loc_779 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc406)
      %offs_d_ckv_1_792 = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc407)
      %offs_k_c_793 = tt.expand_dims %kv_loc_791 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc408)
      %offs_k_c_794 = tt.splat %stride_kv_c_bs : i32 -> tensor<1x32xi32, #blocked1> loc(#loc409)
      %offs_k_c_795 = arith.extsi %offs_k_c_793 : tensor<1x32xi32, #blocked1> to tensor<1x32xi64, #blocked1> loc(#loc409)
      %offs_k_c_796 = arith.extsi %offs_k_c_794 : tensor<1x32xi32, #blocked1> to tensor<1x32xi64, #blocked1> loc(#loc409)
      %offs_k_c_797 = arith.muli %offs_k_c_795, %offs_k_c_796 : tensor<1x32xi64, #blocked1> loc(#loc409)
      %offs_k_c_798 = arith.constant 2147483647 : i64 loc(#loc409)
      %offs_k_c_799 = arith.constant -2147483648 : i64 loc(#loc409)
      %offs_k_c_800 = arith.constant dense<2147483647> : tensor<1x32xi64, #blocked1> loc(#loc409)
      %offs_k_c_801 = arith.cmpi sle, %offs_k_c_797, %offs_k_c_800 : tensor<1x32xi64, #blocked1> loc(#loc409)
      %offs_k_c_802 = arith.constant dense<-2147483648> : tensor<1x32xi64, #blocked1> loc(#loc409)
      %offs_k_c_803 = arith.cmpi sge, %offs_k_c_797, %offs_k_c_802 : tensor<1x32xi64, #blocked1> loc(#loc409)
      %offs_k_c_804 = arith.andi %offs_k_c_801, %offs_k_c_803 : tensor<1x32xi1, #blocked1> loc(#loc409)
      %offs_k_c_805 = arith.muli %offs_k_c_793, %offs_k_c_794 : tensor<1x32xi32, #blocked1> loc(#loc409)
      %offs_k_c_806 = tt.expand_dims %offs_d_ckv_1_792 {axis = 1 : i32} : tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<512x1xi32, #blocked1> loc(#loc410)
      %offs_k_c_807 = tt.broadcast %offs_k_c_805 : tensor<1x32xi32, #blocked1> -> tensor<512x32xi32, #blocked1> loc(#loc411)
      %offs_k_c_808 = tt.broadcast %offs_k_c_806 : tensor<512x1xi32, #blocked1> -> tensor<512x32xi32, #blocked1> loc(#loc411)
      %offs_k_c_809 = arith.extsi %offs_k_c_807 : tensor<512x32xi32, #blocked1> to tensor<512x32xi64, #blocked1> loc(#loc411)
      %offs_k_c_810 = arith.extsi %offs_k_c_808 : tensor<512x32xi32, #blocked1> to tensor<512x32xi64, #blocked1> loc(#loc411)
      %offs_k_c_811 = arith.addi %offs_k_c_809, %offs_k_c_810 : tensor<512x32xi64, #blocked1> loc(#loc411)
      %offs_k_c_812 = arith.constant 2147483647 : i64 loc(#loc411)
      %offs_k_c_813 = arith.constant -2147483648 : i64 loc(#loc411)
      %offs_k_c_814 = arith.constant dense<2147483647> : tensor<512x32xi64, #blocked1> loc(#loc411)
      %offs_k_c_815 = arith.cmpi sle, %offs_k_c_811, %offs_k_c_814 : tensor<512x32xi64, #blocked1> loc(#loc411)
      %offs_k_c_816 = arith.constant dense<-2147483648> : tensor<512x32xi64, #blocked1> loc(#loc411)
      %offs_k_c_817 = arith.cmpi sge, %offs_k_c_811, %offs_k_c_816 : tensor<512x32xi64, #blocked1> loc(#loc411)
      %offs_k_c_818 = arith.andi %offs_k_c_815, %offs_k_c_817 : tensor<512x32xi1, #blocked1> loc(#loc411)
      %offs_k_c_819 = arith.addi %offs_k_c_807, %offs_k_c_808 : tensor<512x32xi32, #blocked1> loc(#loc411)
      %49 = tt.expand_dims %offs_n_764 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc99)
      %50 = tt.splat %cur_batch_seq_len_0 : i32 -> tensor<1x32xi32, #blocked1> loc(#loc100)
      %51 = arith.cmpi slt, %49, %50 : tensor<1x32xi32, #blocked1> loc(#loc100)
      %52 = ttg.memdesc_index %bufs_kv[%async_idx_751] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc101)
      %53 = tt.broadcast %51 : tensor<1x32xi1, #blocked1> -> tensor<512x32xi1, #blocked1> loc(#loc102)
      %54 = amdg.buffer_load_to_local %Kv_c_cache[%offs_k_c_819] mask = %53 into %52 : <bf16>[tensor<512x32xi32, #blocked1>]  -> <512x32xbf16, #shared2, #smem, mutable> loc(#loc102)
      %55 = ttg.async_commit_group loc(#loc103)
      %offs_n_pe_820 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc412)
      %offs_n_pe_821 = tt.splat %start_n_727 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_822 = arith.extsi %offs_n_pe_821 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_823 = arith.extsi %offs_n_pe_820 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_824 = arith.addi %offs_n_pe_822, %offs_n_pe_823 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_825 = arith.constant 2147483647 : i64 loc(#loc413)
      %offs_n_pe_826 = arith.constant -2147483648 : i64 loc(#loc413)
      %offs_n_pe_827 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_828 = arith.cmpi sle, %offs_n_pe_824, %offs_n_pe_827 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_829 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_830 = arith.cmpi sge, %offs_n_pe_824, %offs_n_pe_829 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_831 = arith.andi %offs_n_pe_828, %offs_n_pe_830 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %offs_n_pe_832 = arith.addi %offs_n_pe_821, %offs_n_pe_820 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc413)
      %kv_loc_pe_833 = arith.constant 64 : i32 loc(#loc414)
      %kv_loc_pe_834 = arith.constant 64 : i32 loc(#loc414)
      %kv_loc_pe_835 = arith.extsi %kv_page_number_728 : i32 to i64 loc(#loc414)
      %kv_loc_pe_836 = arith.extsi %kv_loc_pe_834 : i32 to i64 loc(#loc414)
      %kv_loc_pe_837 = arith.muli %kv_loc_pe_835, %kv_loc_pe_836 : i64 loc(#loc414)
      %kv_loc_pe_838 = arith.constant 2147483647 : i64 loc(#loc414)
      %kv_loc_pe_839 = arith.constant -2147483648 : i64 loc(#loc414)
      %kv_loc_pe_840 = arith.cmpi sle, %kv_loc_pe_837, %kv_loc_pe_838 : i64 loc(#loc414)
      %kv_loc_pe_841 = arith.cmpi sge, %kv_loc_pe_837, %kv_loc_pe_839 : i64 loc(#loc414)
      %kv_loc_pe_842 = arith.andi %kv_loc_pe_840, %kv_loc_pe_841 : i1 loc(#loc414)
      %kv_loc_pe_843 = arith.muli %kv_page_number_728, %kv_loc_pe_834 : i32 loc(#loc414)
      %kv_loc_pe_844 = arith.constant 64 : i32 loc(#loc415)
      %kv_loc_pe_845 = arith.constant 64 : i32 loc(#loc415)
      %kv_loc_pe_846 = arith.constant dense<64> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc415)
      %kv_loc_pe_847 = arith.remsi %offs_n_pe_832, %kv_loc_pe_846 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc415)
      %kv_loc_pe_848 = tt.splat %kv_loc_pe_843 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_849 = arith.extsi %kv_loc_pe_848 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_850 = arith.extsi %kv_loc_pe_847 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_851 = arith.addi %kv_loc_pe_849, %kv_loc_pe_850 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_852 = arith.constant 2147483647 : i64 loc(#loc416)
      %kv_loc_pe_853 = arith.constant -2147483648 : i64 loc(#loc416)
      %kv_loc_pe_854 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_855 = arith.cmpi sle, %kv_loc_pe_851, %kv_loc_pe_854 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_856 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_857 = arith.cmpi sge, %kv_loc_pe_851, %kv_loc_pe_856 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_858 = arith.andi %kv_loc_pe_855, %kv_loc_pe_857 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %kv_loc_pe_859 = arith.addi %kv_loc_pe_848, %kv_loc_pe_847 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc416)
      %offs_d_kpe_1_860 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>> loc(#loc417)
      %offs_k_pe_861 = tt.expand_dims %kv_loc_pe_859 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> -> tensor<1x32xi32, #linear1> loc(#loc418)
      %offs_k_pe_862 = tt.splat %stride_k_pe_bs : i32 -> tensor<1x32xi32, #linear1> loc(#loc419)
      %offs_k_pe_863 = arith.extsi %offs_k_pe_861 : tensor<1x32xi32, #linear1> to tensor<1x32xi64, #linear1> loc(#loc419)
      %offs_k_pe_864 = arith.extsi %offs_k_pe_862 : tensor<1x32xi32, #linear1> to tensor<1x32xi64, #linear1> loc(#loc419)
      %offs_k_pe_865 = arith.muli %offs_k_pe_863, %offs_k_pe_864 : tensor<1x32xi64, #linear1> loc(#loc419)
      %offs_k_pe_866 = arith.constant 2147483647 : i64 loc(#loc419)
      %offs_k_pe_867 = arith.constant -2147483648 : i64 loc(#loc419)
      %offs_k_pe_868 = arith.constant dense<2147483647> : tensor<1x32xi64, #linear1> loc(#loc419)
      %offs_k_pe_869 = arith.cmpi sle, %offs_k_pe_865, %offs_k_pe_868 : tensor<1x32xi64, #linear1> loc(#loc419)
      %offs_k_pe_870 = arith.constant dense<-2147483648> : tensor<1x32xi64, #linear1> loc(#loc419)
      %offs_k_pe_871 = arith.cmpi sge, %offs_k_pe_865, %offs_k_pe_870 : tensor<1x32xi64, #linear1> loc(#loc419)
      %offs_k_pe_872 = arith.andi %offs_k_pe_869, %offs_k_pe_871 : tensor<1x32xi1, #linear1> loc(#loc419)
      %offs_k_pe_873 = arith.muli %offs_k_pe_861, %offs_k_pe_862 : tensor<1x32xi32, #linear1> loc(#loc419)
      %offs_k_pe_874 = tt.expand_dims %offs_d_kpe_1_860 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>> -> tensor<64x1xi32, #linear1> loc(#loc420)
      %offs_k_pe_875 = tt.broadcast %offs_k_pe_873 : tensor<1x32xi32, #linear1> -> tensor<64x32xi32, #linear1> loc(#loc421)
      %offs_k_pe_876 = tt.broadcast %offs_k_pe_874 : tensor<64x1xi32, #linear1> -> tensor<64x32xi32, #linear1> loc(#loc421)
      %offs_k_pe_877 = arith.extsi %offs_k_pe_875 : tensor<64x32xi32, #linear1> to tensor<64x32xi64, #linear1> loc(#loc421)
      %offs_k_pe_878 = arith.extsi %offs_k_pe_876 : tensor<64x32xi32, #linear1> to tensor<64x32xi64, #linear1> loc(#loc421)
      %offs_k_pe_879 = arith.addi %offs_k_pe_877, %offs_k_pe_878 : tensor<64x32xi64, #linear1> loc(#loc421)
      %offs_k_pe_880 = arith.constant 2147483647 : i64 loc(#loc421)
      %offs_k_pe_881 = arith.constant -2147483648 : i64 loc(#loc421)
      %offs_k_pe_882 = arith.constant dense<2147483647> : tensor<64x32xi64, #linear1> loc(#loc421)
      %offs_k_pe_883 = arith.cmpi sle, %offs_k_pe_879, %offs_k_pe_882 : tensor<64x32xi64, #linear1> loc(#loc421)
      %offs_k_pe_884 = arith.constant dense<-2147483648> : tensor<64x32xi64, #linear1> loc(#loc421)
      %offs_k_pe_885 = arith.cmpi sge, %offs_k_pe_879, %offs_k_pe_884 : tensor<64x32xi64, #linear1> loc(#loc421)
      %offs_k_pe_886 = arith.andi %offs_k_pe_883, %offs_k_pe_885 : tensor<64x32xi1, #linear1> loc(#loc421)
      %offs_k_pe_887 = arith.addi %offs_k_pe_875, %offs_k_pe_876 : tensor<64x32xi32, #linear1> loc(#loc421)
      %56 = tt.expand_dims %offs_n_pe_832 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> -> tensor<1x32xi32, #linear1> loc(#loc114)
      %57 = tt.splat %cur_batch_seq_len_0 : i32 -> tensor<1x32xi32, #linear1> loc(#loc115)
      %58 = arith.cmpi slt, %56, %57 : tensor<1x32xi32, #linear1> loc(#loc115)
      %59 = ttg.memdesc_index %bufs_kpe[%async_idx_751] : !ttg.memdesc<2x64x32xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> loc(#loc116)
      %60 = tt.broadcast %58 : tensor<1x32xi1, #linear1> -> tensor<64x32xi1, #linear1> loc(#loc117)
      %61 = amdg.buffer_load_to_local %K_pe_cache[%offs_k_pe_887] mask = %60 into %59 : <bf16>[tensor<64x32xi32, #linear1>]  -> <64x32xbf16, #shared3, #smem, mutable> loc(#loc117)
      %62 = ttg.async_commit_group loc(#loc118)
      %start_n_888 = arith.constant 32 : i32 loc(#loc422)
      %start_n_889 = arith.constant 32 : i32 loc(#loc422)
      %start_n_890 = arith.extsi %start_n_727 : i32 to i64 loc(#loc422)
      %start_n_891 = arith.extsi %start_n_889 : i32 to i64 loc(#loc422)
      %start_n_892 = arith.addi %start_n_890, %start_n_891 : i64 loc(#loc422)
      %start_n_893 = arith.constant 2147483647 : i64 loc(#loc422)
      %start_n_894 = arith.constant -2147483648 : i64 loc(#loc422)
      %start_n_895 = arith.cmpi sle, %start_n_892, %start_n_893 : i64 loc(#loc422)
      %start_n_896 = arith.cmpi sge, %start_n_892, %start_n_894 : i64 loc(#loc422)
      %start_n_897 = arith.andi %start_n_895, %start_n_896 : i1 loc(#loc422)
      %start_n_898 = arith.addi %start_n_727, %start_n_889 : i32 loc(#loc422)
      %kv_page_number_899 = arith.extsi %stride_req_to_tokens_bs : i32 to i64 loc(#loc423)
      %kv_page_number_900 = arith.extsi %cur_batch : i32 to i64 loc(#loc423)
      %kv_page_number_901 = arith.muli %kv_page_number_899, %kv_page_number_900 : i64 loc(#loc423)
      %kv_page_number_902 = arith.constant 2147483647 : i64 loc(#loc423)
      %kv_page_number_903 = arith.constant -2147483648 : i64 loc(#loc423)
      %kv_page_number_904 = arith.cmpi sle, %kv_page_number_901, %kv_page_number_902 : i64 loc(#loc423)
      %kv_page_number_905 = arith.cmpi sge, %kv_page_number_901, %kv_page_number_903 : i64 loc(#loc423)
      %kv_page_number_906 = arith.andi %kv_page_number_904, %kv_page_number_905 : i1 loc(#loc423)
      %kv_page_number_907 = arith.muli %stride_req_to_tokens_bs, %cur_batch : i32 loc(#loc423)
      %kv_page_number_908 = tt.addptr %Req_to_tokens, %kv_page_number_907 : !tt.ptr<i32>, i32 loc(#loc424)
      %kv_page_number_909 = arith.constant 64 : i32 loc(#loc425)
      %kv_page_number_910 = arith.constant 64 : i32 loc(#loc425)
      %kv_page_number_911 = arith.divsi %start_n_898, %kv_page_number_910 : i32 loc(#loc425)
      %kv_page_number_912 = tt.addptr %kv_page_number_908, %kv_page_number_911 : !tt.ptr<i32>, i32 loc(#loc426)
      %kv_page_number_913 = tt.load %kv_page_number_912 : !tt.ptr<i32> loc(#loc427)
      %63 = ttg.async_wait {num = 3 : i32} loc(#loc125)
      %k_c_914 = ttg.memdesc_index %bufs_kv[%buf_idx_737] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc428)
      %k_c_915 = ttg.local_load %k_c_914 : !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> -> tensor<512x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc429)
      %zeros_916 = tt.call @triton.experimental.gluon.language._standard.zeros__Tc64_c32T_cfp32_cMFMA_4_16_16_32_True_4_1_32_1_1__MFMA() : () -> tensor<64x32xf32, #mma> loc(#loc430)
      %qk_917 = arith.constant 0.000000e+00 : f32 loc(#loc431)
      %qk_918 = tt.dot %q_nope, %k_c_915, %zeros_916 : tensor<64x512xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<512x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x32xf32, #mma> loc(#loc431)
      %64 = ttg.async_wait {num = 2 : i32} loc(#loc130)
      %k_pe_919 = ttg.memdesc_index %bufs_kpe[%buf_idx_737] : !ttg.memdesc<2x64x32xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> loc(#loc432)
      %k_pe_920 = ttg.local_load %k_pe_919 : !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc433)
      %qk_921 = arith.constant 0.000000e+00 : f32 loc(#loc434)
      %qk_922 = tt.dot %q_pe, %k_pe_920, %qk_918 : tensor<64x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x32xf32, #mma> loc(#loc434)
      %qk_923 = tt.splat %sm_scale : f32 -> tensor<64x32xf32, #mma> loc(#loc435)
      %qk_924 = arith.mulf %qk_922, %qk_923 : tensor<64x32xf32, #mma> loc(#loc435)
      %offs_n_qk_925 = arith.constant 32 : i32 loc(#loc436)
      %offs_n_qk_926 = arith.constant 32 : i32 loc(#loc436)
      %offs_n_qk_927 = arith.extsi %i : i32 to i64 loc(#loc436)
      %offs_n_qk_928 = arith.extsi %offs_n_qk_926 : i32 to i64 loc(#loc436)
      %offs_n_qk_929 = arith.muli %offs_n_qk_927, %offs_n_qk_928 : i64 loc(#loc436)
      %offs_n_qk_930 = arith.constant 2147483647 : i64 loc(#loc436)
      %offs_n_qk_931 = arith.constant -2147483648 : i64 loc(#loc436)
      %offs_n_qk_932 = arith.cmpi sle, %offs_n_qk_929, %offs_n_qk_930 : i64 loc(#loc436)
      %offs_n_qk_933 = arith.cmpi sge, %offs_n_qk_929, %offs_n_qk_931 : i64 loc(#loc436)
      %offs_n_qk_934 = arith.andi %offs_n_qk_932, %offs_n_qk_933 : i1 loc(#loc436)
      %offs_n_qk_935 = arith.muli %i, %offs_n_qk_926 : i32 loc(#loc436)
      %offs_n_qk_936 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc437)
      %offs_n_qk_937 = tt.splat %offs_n_qk_935 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_938 = arith.extsi %offs_n_qk_937 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_939 = arith.extsi %offs_n_qk_936 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_940 = arith.addi %offs_n_qk_938, %offs_n_qk_939 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_941 = arith.constant 2147483647 : i64 loc(#loc438)
      %offs_n_qk_942 = arith.constant -2147483648 : i64 loc(#loc438)
      %offs_n_qk_943 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_944 = arith.cmpi sle, %offs_n_qk_940, %offs_n_qk_943 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_945 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_946 = arith.cmpi sge, %offs_n_qk_940, %offs_n_qk_945 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_947 = arith.andi %offs_n_qk_944, %offs_n_qk_946 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %offs_n_qk_948 = arith.addi %offs_n_qk_937, %offs_n_qk_936 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc438)
      %qk_949 = tt.expand_dims %offs_n_qk_948 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc439)
      %qk_950 = tt.splat %cur_batch_seq_len_0 : i32 -> tensor<1x32xi32, #mma> loc(#loc440)
      %qk_951 = arith.cmpi slt, %qk_949, %qk_950 : tensor<1x32xi32, #mma> loc(#loc440)
      %qk_952 = arith.constant 0xFF800000 : f32 loc(#loc441)
      %qk_953 = arith.constant 0xFF800000 : f32 loc(#loc441)
      %qk_954 = arith.constant dense<0xFF800000> : tensor<64x32xf32, #mma> loc(#loc441)
      %qk_955 = tt.broadcast %qk_951 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc441)
      %qk_956 = arith.select %qk_955, %qk_924, %qk_954 : tensor<64x32xi1, #mma>, tensor<64x32xf32, #mma> loc(#loc441)
      %n_e_max_957 = tt.call @triton.language.standard.max__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cTrue_cFalse(%qk_956) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc442)
      %n_e_max_958 = arith.maxnumf %n_e_max_957, %e_max_724 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc443)
      %re_scale_959 = arith.subf %e_max_724, %n_e_max_958 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc444)
      %re_scale_960 = math.exp %re_scale_959 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc445)
      %p_961 = tt.expand_dims %n_e_max_958 {axis = 1 : i32} : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xf32, #mma> loc(#loc446)
      %p_962 = tt.broadcast %p_961 : tensor<64x1xf32, #mma> -> tensor<64x32xf32, #mma> loc(#loc447)
      %p_963 = arith.subf %qk_956, %p_962 : tensor<64x32xf32, #mma> loc(#loc447)
      %p_964 = math.exp %p_963 : tensor<64x32xf32, #mma> loc(#loc448)
      %e_sum_965 = arith.mulf %e_sum_725, %re_scale_960 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc449)
      %e_sum_966 = tt.call @triton.language.standard.sum__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cNone(%p_964) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc450)
      %e_sum_967 = arith.addf %e_sum_965, %e_sum_966 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc451)
      %p_968 = arith.truncf %p_964 : tensor<64x32xf32, #mma> to tensor<64x32xbf16, #mma> loc(#loc452)
      %p_969 = ttg.convert_layout %p_968 : tensor<64x32xbf16, #mma> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> loc(#loc453)
      %acc_970 = tt.expand_dims %re_scale_960 {axis = 1 : i32} : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xf32, #mma> loc(#loc454)
      %acc_971 = tt.broadcast %acc_970 : tensor<64x1xf32, #mma> -> tensor<64x512xf32, #mma> loc(#loc455)
      %acc_972 = arith.mulf %acc_726, %acc_971 : tensor<64x512xf32, #mma> loc(#loc455)
      %v_c_973 = ttg.memdesc_index %bufs_kv[%buf_idx_737] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc456)
      %v_c_974 = ttg.local_load %v_c_973 : !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> -> tensor<512x32xbf16, #linear2> loc(#loc457)
      %v_c_975 = tt.trans %v_c_974 {order = array<i32: 1, 0>} : tensor<512x32xbf16, #linear2> -> tensor<32x512xbf16, #linear3> loc(#loc458)
      %v_c_976 = ttg.convert_layout %v_c_975 : tensor<32x512xbf16, #linear3> -> tensor<32x512xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc459)
      %acc_977 = arith.constant 0.000000e+00 : f32 loc(#loc460)
      %acc_978 = tt.dot %p_969, %v_c_976, %acc_972 : tensor<64x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<32x512xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x512xf32, #mma> loc(#loc460)
      %buf_idx_979 = arith.constant 1 : i32 loc(#loc461)
      %buf_idx_980 = arith.constant 1 : i32 loc(#loc461)
      %buf_idx_981 = arith.extsi %buf_idx_737 : i32 to i64 loc(#loc461)
      %buf_idx_982 = arith.extsi %buf_idx_980 : i32 to i64 loc(#loc461)
      %buf_idx_983 = arith.addi %buf_idx_981, %buf_idx_982 : i64 loc(#loc461)
      %buf_idx_984 = arith.constant 2147483647 : i64 loc(#loc461)
      %buf_idx_985 = arith.constant -2147483648 : i64 loc(#loc461)
      %buf_idx_986 = arith.cmpi sle, %buf_idx_983, %buf_idx_984 : i64 loc(#loc461)
      %buf_idx_987 = arith.cmpi sge, %buf_idx_983, %buf_idx_985 : i64 loc(#loc461)
      %buf_idx_988 = arith.andi %buf_idx_986, %buf_idx_987 : i1 loc(#loc461)
      %buf_idx_989 = arith.addi %buf_idx_737, %buf_idx_980 : i32 loc(#loc461)
      %buf_idx_990 = arith.constant 2 : i32 loc(#loc462)
      %buf_idx_991 = arith.constant 2 : i32 loc(#loc462)
      %buf_idx_992 = arith.remsi %buf_idx_989, %buf_idx_991 : i32 loc(#loc462)
      scf.yield %n_e_max_958, %e_sum_967, %acc_978, %start_n_898, %kv_page_number_913, %offs_n_764, %kv_loc_791, %offs_d_ckv_1_792, %offs_k_c_819, %offs_n_pe_832, %kv_loc_pe_859, %offs_d_kpe_1_860, %offs_k_pe_887, %buf_idx_992 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>>, tensor<64x512xf32, #mma>, i32, i32, tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>>, tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>>, tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>>, tensor<512x32xi32, #blocked1>, tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>>, tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>>, tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>>, tensor<64x32xi32, #linear1>, i32 loc(#loc162)
    } loc(#loc590)
    %async_idx = arith.constant 1 : i32 loc(#loc463)
    %async_idx_321 = arith.constant 1 : i32 loc(#loc463)
    %async_idx_322 = arith.extsi %buf_idx_320#13 : i32 to i64 loc(#loc463)
    %async_idx_323 = arith.extsi %async_idx_321 : i32 to i64 loc(#loc463)
    %async_idx_324 = arith.addi %async_idx_322, %async_idx_323 : i64 loc(#loc463)
    %async_idx_325 = arith.constant 2147483647 : i64 loc(#loc463)
    %async_idx_326 = arith.constant -2147483648 : i64 loc(#loc463)
    %async_idx_327 = arith.cmpi sle, %async_idx_324, %async_idx_325 : i64 loc(#loc463)
    %async_idx_328 = arith.cmpi sge, %async_idx_324, %async_idx_326 : i64 loc(#loc463)
    %async_idx_329 = arith.andi %async_idx_327, %async_idx_328 : i1 loc(#loc463)
    %async_idx_330 = arith.addi %buf_idx_320#13, %async_idx_321 : i32 loc(#loc463)
    %async_idx_331 = arith.constant 2 : i32 loc(#loc464)
    %async_idx_332 = arith.constant 2 : i32 loc(#loc464)
    %async_idx_333 = arith.remsi %async_idx_330, %async_idx_332 : i32 loc(#loc464)
    %offs_n_334 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc465)
    %offs_n_335 = tt.splat %buf_idx_320#3 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_336 = arith.extsi %offs_n_335 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_337 = arith.extsi %offs_n_334 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_338 = arith.addi %offs_n_336, %offs_n_337 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_339 = arith.constant 2147483647 : i64 loc(#loc466)
    %offs_n_340 = arith.constant -2147483648 : i64 loc(#loc466)
    %offs_n_341 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_342 = arith.cmpi sle, %offs_n_338, %offs_n_341 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_343 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_344 = arith.cmpi sge, %offs_n_338, %offs_n_343 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_345 = arith.andi %offs_n_342, %offs_n_344 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %offs_n_346 = arith.addi %offs_n_335, %offs_n_334 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc466)
    %kv_loc_347 = arith.constant 64 : i32 loc(#loc467)
    %kv_loc_348 = arith.constant 64 : i32 loc(#loc467)
    %kv_loc_349 = arith.extsi %buf_idx_320#4 : i32 to i64 loc(#loc467)
    %kv_loc_350 = arith.extsi %kv_loc_348 : i32 to i64 loc(#loc467)
    %kv_loc_351 = arith.muli %kv_loc_349, %kv_loc_350 : i64 loc(#loc467)
    %kv_loc_352 = arith.constant 2147483647 : i64 loc(#loc467)
    %kv_loc_353 = arith.constant -2147483648 : i64 loc(#loc467)
    %kv_loc_354 = arith.cmpi sle, %kv_loc_351, %kv_loc_352 : i64 loc(#loc467)
    %kv_loc_355 = arith.cmpi sge, %kv_loc_351, %kv_loc_353 : i64 loc(#loc467)
    %kv_loc_356 = arith.andi %kv_loc_354, %kv_loc_355 : i1 loc(#loc467)
    %kv_loc_357 = arith.muli %buf_idx_320#4, %kv_loc_348 : i32 loc(#loc467)
    %kv_loc_358 = arith.constant 64 : i32 loc(#loc468)
    %kv_loc_359 = arith.constant 64 : i32 loc(#loc468)
    %kv_loc_360 = arith.constant dense<64> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc468)
    %kv_loc_361 = arith.remsi %offs_n_346, %kv_loc_360 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc468)
    %kv_loc_362 = tt.splat %kv_loc_357 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_363 = arith.extsi %kv_loc_362 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_364 = arith.extsi %kv_loc_361 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_365 = arith.addi %kv_loc_363, %kv_loc_364 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_366 = arith.constant 2147483647 : i64 loc(#loc469)
    %kv_loc_367 = arith.constant -2147483648 : i64 loc(#loc469)
    %kv_loc_368 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_369 = arith.cmpi sle, %kv_loc_365, %kv_loc_368 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_370 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_371 = arith.cmpi sge, %kv_loc_365, %kv_loc_370 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_372 = arith.andi %kv_loc_369, %kv_loc_371 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %kv_loc_373 = arith.addi %kv_loc_362, %kv_loc_361 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc469)
    %offs_d_ckv_1_374 = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc470)
    %offs_k_c_375 = tt.expand_dims %kv_loc_373 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc471)
    %offs_k_c_376 = tt.splat %stride_kv_c_bs : i32 -> tensor<1x32xi32, #blocked1> loc(#loc472)
    %offs_k_c_377 = arith.extsi %offs_k_c_375 : tensor<1x32xi32, #blocked1> to tensor<1x32xi64, #blocked1> loc(#loc472)
    %offs_k_c_378 = arith.extsi %offs_k_c_376 : tensor<1x32xi32, #blocked1> to tensor<1x32xi64, #blocked1> loc(#loc472)
    %offs_k_c_379 = arith.muli %offs_k_c_377, %offs_k_c_378 : tensor<1x32xi64, #blocked1> loc(#loc472)
    %offs_k_c_380 = arith.constant 2147483647 : i64 loc(#loc472)
    %offs_k_c_381 = arith.constant -2147483648 : i64 loc(#loc472)
    %offs_k_c_382 = arith.constant dense<2147483647> : tensor<1x32xi64, #blocked1> loc(#loc472)
    %offs_k_c_383 = arith.cmpi sle, %offs_k_c_379, %offs_k_c_382 : tensor<1x32xi64, #blocked1> loc(#loc472)
    %offs_k_c_384 = arith.constant dense<-2147483648> : tensor<1x32xi64, #blocked1> loc(#loc472)
    %offs_k_c_385 = arith.cmpi sge, %offs_k_c_379, %offs_k_c_384 : tensor<1x32xi64, #blocked1> loc(#loc472)
    %offs_k_c_386 = arith.andi %offs_k_c_383, %offs_k_c_385 : tensor<1x32xi1, #blocked1> loc(#loc472)
    %offs_k_c_387 = arith.muli %offs_k_c_375, %offs_k_c_376 : tensor<1x32xi32, #blocked1> loc(#loc472)
    %offs_k_c_388 = tt.expand_dims %offs_d_ckv_1_374 {axis = 1 : i32} : tensor<512xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<512x1xi32, #blocked1> loc(#loc473)
    %offs_k_c_389 = tt.broadcast %offs_k_c_387 : tensor<1x32xi32, #blocked1> -> tensor<512x32xi32, #blocked1> loc(#loc474)
    %offs_k_c_390 = tt.broadcast %offs_k_c_388 : tensor<512x1xi32, #blocked1> -> tensor<512x32xi32, #blocked1> loc(#loc474)
    %offs_k_c_391 = arith.extsi %offs_k_c_389 : tensor<512x32xi32, #blocked1> to tensor<512x32xi64, #blocked1> loc(#loc474)
    %offs_k_c_392 = arith.extsi %offs_k_c_390 : tensor<512x32xi32, #blocked1> to tensor<512x32xi64, #blocked1> loc(#loc474)
    %offs_k_c_393 = arith.addi %offs_k_c_391, %offs_k_c_392 : tensor<512x32xi64, #blocked1> loc(#loc474)
    %offs_k_c_394 = arith.constant 2147483647 : i64 loc(#loc474)
    %offs_k_c_395 = arith.constant -2147483648 : i64 loc(#loc474)
    %offs_k_c_396 = arith.constant dense<2147483647> : tensor<512x32xi64, #blocked1> loc(#loc474)
    %offs_k_c_397 = arith.cmpi sle, %offs_k_c_393, %offs_k_c_396 : tensor<512x32xi64, #blocked1> loc(#loc474)
    %offs_k_c_398 = arith.constant dense<-2147483648> : tensor<512x32xi64, #blocked1> loc(#loc474)
    %offs_k_c_399 = arith.cmpi sge, %offs_k_c_393, %offs_k_c_398 : tensor<512x32xi64, #blocked1> loc(#loc474)
    %offs_k_c_400 = arith.andi %offs_k_c_397, %offs_k_c_399 : tensor<512x32xi1, #blocked1> loc(#loc474)
    %offs_k_c_401 = arith.addi %offs_k_c_389, %offs_k_c_390 : tensor<512x32xi32, #blocked1> loc(#loc474)
    %31 = tt.expand_dims %offs_n_346 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc175)
    %32 = tt.splat %cur_batch_seq_len_0 : i32 -> tensor<1x32xi32, #blocked1> loc(#loc176)
    %33 = arith.cmpi slt, %31, %32 : tensor<1x32xi32, #blocked1> loc(#loc176)
    %34 = ttg.memdesc_index %bufs_kv[%async_idx_333] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc177)
    %35 = tt.broadcast %33 : tensor<1x32xi1, #blocked1> -> tensor<512x32xi1, #blocked1> loc(#loc178)
    %36 = amdg.buffer_load_to_local %Kv_c_cache[%offs_k_c_401] mask = %35 into %34 : <bf16>[tensor<512x32xi32, #blocked1>]  -> <512x32xbf16, #shared2, #smem, mutable> loc(#loc178)
    %37 = ttg.async_commit_group loc(#loc179)
    %offs_n_pe_402 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc475)
    %offs_n_pe_403 = tt.splat %buf_idx_320#3 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_404 = arith.extsi %offs_n_pe_403 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_405 = arith.extsi %offs_n_pe_402 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_406 = arith.addi %offs_n_pe_404, %offs_n_pe_405 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_407 = arith.constant 2147483647 : i64 loc(#loc476)
    %offs_n_pe_408 = arith.constant -2147483648 : i64 loc(#loc476)
    %offs_n_pe_409 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_410 = arith.cmpi sle, %offs_n_pe_406, %offs_n_pe_409 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_411 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_412 = arith.cmpi sge, %offs_n_pe_406, %offs_n_pe_411 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_413 = arith.andi %offs_n_pe_410, %offs_n_pe_412 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %offs_n_pe_414 = arith.addi %offs_n_pe_403, %offs_n_pe_402 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc476)
    %kv_loc_pe_415 = arith.constant 64 : i32 loc(#loc477)
    %kv_loc_pe_416 = arith.constant 64 : i32 loc(#loc477)
    %kv_loc_pe_417 = arith.extsi %buf_idx_320#4 : i32 to i64 loc(#loc477)
    %kv_loc_pe_418 = arith.extsi %kv_loc_pe_416 : i32 to i64 loc(#loc477)
    %kv_loc_pe_419 = arith.muli %kv_loc_pe_417, %kv_loc_pe_418 : i64 loc(#loc477)
    %kv_loc_pe_420 = arith.constant 2147483647 : i64 loc(#loc477)
    %kv_loc_pe_421 = arith.constant -2147483648 : i64 loc(#loc477)
    %kv_loc_pe_422 = arith.cmpi sle, %kv_loc_pe_419, %kv_loc_pe_420 : i64 loc(#loc477)
    %kv_loc_pe_423 = arith.cmpi sge, %kv_loc_pe_419, %kv_loc_pe_421 : i64 loc(#loc477)
    %kv_loc_pe_424 = arith.andi %kv_loc_pe_422, %kv_loc_pe_423 : i1 loc(#loc477)
    %kv_loc_pe_425 = arith.muli %buf_idx_320#4, %kv_loc_pe_416 : i32 loc(#loc477)
    %kv_loc_pe_426 = arith.constant 64 : i32 loc(#loc478)
    %kv_loc_pe_427 = arith.constant 64 : i32 loc(#loc478)
    %kv_loc_pe_428 = arith.constant dense<64> : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc478)
    %kv_loc_pe_429 = arith.remsi %offs_n_pe_414, %kv_loc_pe_428 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc478)
    %kv_loc_pe_430 = tt.splat %kv_loc_pe_425 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_431 = arith.extsi %kv_loc_pe_430 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_432 = arith.extsi %kv_loc_pe_429 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_433 = arith.addi %kv_loc_pe_431, %kv_loc_pe_432 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_434 = arith.constant 2147483647 : i64 loc(#loc479)
    %kv_loc_pe_435 = arith.constant -2147483648 : i64 loc(#loc479)
    %kv_loc_pe_436 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_437 = arith.cmpi sle, %kv_loc_pe_433, %kv_loc_pe_436 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_438 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_439 = arith.cmpi sge, %kv_loc_pe_433, %kv_loc_pe_438 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_440 = arith.andi %kv_loc_pe_437, %kv_loc_pe_439 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %kv_loc_pe_441 = arith.addi %kv_loc_pe_430, %kv_loc_pe_429 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> loc(#loc479)
    %offs_d_kpe_1_442 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>> loc(#loc480)
    %offs_k_pe_443 = tt.expand_dims %kv_loc_pe_441 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> -> tensor<1x32xi32, #linear1> loc(#loc481)
    %offs_k_pe_444 = tt.splat %stride_k_pe_bs : i32 -> tensor<1x32xi32, #linear1> loc(#loc482)
    %offs_k_pe_445 = arith.extsi %offs_k_pe_443 : tensor<1x32xi32, #linear1> to tensor<1x32xi64, #linear1> loc(#loc482)
    %offs_k_pe_446 = arith.extsi %offs_k_pe_444 : tensor<1x32xi32, #linear1> to tensor<1x32xi64, #linear1> loc(#loc482)
    %offs_k_pe_447 = arith.muli %offs_k_pe_445, %offs_k_pe_446 : tensor<1x32xi64, #linear1> loc(#loc482)
    %offs_k_pe_448 = arith.constant 2147483647 : i64 loc(#loc482)
    %offs_k_pe_449 = arith.constant -2147483648 : i64 loc(#loc482)
    %offs_k_pe_450 = arith.constant dense<2147483647> : tensor<1x32xi64, #linear1> loc(#loc482)
    %offs_k_pe_451 = arith.cmpi sle, %offs_k_pe_447, %offs_k_pe_450 : tensor<1x32xi64, #linear1> loc(#loc482)
    %offs_k_pe_452 = arith.constant dense<-2147483648> : tensor<1x32xi64, #linear1> loc(#loc482)
    %offs_k_pe_453 = arith.cmpi sge, %offs_k_pe_447, %offs_k_pe_452 : tensor<1x32xi64, #linear1> loc(#loc482)
    %offs_k_pe_454 = arith.andi %offs_k_pe_451, %offs_k_pe_453 : tensor<1x32xi1, #linear1> loc(#loc482)
    %offs_k_pe_455 = arith.muli %offs_k_pe_443, %offs_k_pe_444 : tensor<1x32xi32, #linear1> loc(#loc482)
    %offs_k_pe_456 = tt.expand_dims %offs_d_kpe_1_442 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #linear1}>> -> tensor<64x1xi32, #linear1> loc(#loc483)
    %offs_k_pe_457 = tt.broadcast %offs_k_pe_455 : tensor<1x32xi32, #linear1> -> tensor<64x32xi32, #linear1> loc(#loc484)
    %offs_k_pe_458 = tt.broadcast %offs_k_pe_456 : tensor<64x1xi32, #linear1> -> tensor<64x32xi32, #linear1> loc(#loc484)
    %offs_k_pe_459 = arith.extsi %offs_k_pe_457 : tensor<64x32xi32, #linear1> to tensor<64x32xi64, #linear1> loc(#loc484)
    %offs_k_pe_460 = arith.extsi %offs_k_pe_458 : tensor<64x32xi32, #linear1> to tensor<64x32xi64, #linear1> loc(#loc484)
    %offs_k_pe_461 = arith.addi %offs_k_pe_459, %offs_k_pe_460 : tensor<64x32xi64, #linear1> loc(#loc484)
    %offs_k_pe_462 = arith.constant 2147483647 : i64 loc(#loc484)
    %offs_k_pe_463 = arith.constant -2147483648 : i64 loc(#loc484)
    %offs_k_pe_464 = arith.constant dense<2147483647> : tensor<64x32xi64, #linear1> loc(#loc484)
    %offs_k_pe_465 = arith.cmpi sle, %offs_k_pe_461, %offs_k_pe_464 : tensor<64x32xi64, #linear1> loc(#loc484)
    %offs_k_pe_466 = arith.constant dense<-2147483648> : tensor<64x32xi64, #linear1> loc(#loc484)
    %offs_k_pe_467 = arith.cmpi sge, %offs_k_pe_461, %offs_k_pe_466 : tensor<64x32xi64, #linear1> loc(#loc484)
    %offs_k_pe_468 = arith.andi %offs_k_pe_465, %offs_k_pe_467 : tensor<64x32xi1, #linear1> loc(#loc484)
    %offs_k_pe_469 = arith.addi %offs_k_pe_457, %offs_k_pe_458 : tensor<64x32xi32, #linear1> loc(#loc484)
    %38 = tt.expand_dims %offs_n_pe_414 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #linear1}>> -> tensor<1x32xi32, #linear1> loc(#loc190)
    %39 = tt.splat %cur_batch_seq_len_0 : i32 -> tensor<1x32xi32, #linear1> loc(#loc191)
    %40 = arith.cmpi slt, %38, %39 : tensor<1x32xi32, #linear1> loc(#loc191)
    %41 = ttg.memdesc_index %bufs_kpe[%async_idx_333] : !ttg.memdesc<2x64x32xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> loc(#loc192)
    %42 = tt.broadcast %40 : tensor<1x32xi1, #linear1> -> tensor<64x32xi1, #linear1> loc(#loc193)
    %43 = amdg.buffer_load_to_local %K_pe_cache[%offs_k_pe_469] mask = %42 into %41 : <bf16>[tensor<64x32xi32, #linear1>]  -> <64x32xbf16, #shared3, #smem, mutable> loc(#loc193)
    %44 = ttg.async_commit_group loc(#loc194)
    %45 = ttg.async_wait {num = 3 : i32} loc(#loc195)
    %k_c = ttg.memdesc_index %bufs_kv[%buf_idx_320#13] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc485)
    %k_c_470 = ttg.local_load %k_c : !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> -> tensor<512x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc486)
    %zeros = tt.call @triton.experimental.gluon.language._standard.zeros__Tc64_c32T_cfp32_cMFMA_4_16_16_32_True_4_1_32_1_1__MFMA() : () -> tensor<64x32xf32, #mma> loc(#loc487)
    %qk = arith.constant 0.000000e+00 : f32 loc(#loc488)
    %qk_471 = tt.dot %q_nope, %k_c_470, %zeros : tensor<64x512xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<512x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x32xf32, #mma> loc(#loc488)
    %46 = ttg.async_wait {num = 2 : i32} loc(#loc200)
    %k_pe = ttg.memdesc_index %bufs_kpe[%buf_idx_320#13] : !ttg.memdesc<2x64x32xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> loc(#loc489)
    %k_pe_472 = ttg.local_load %k_pe : !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc490)
    %qk_473 = arith.constant 0.000000e+00 : f32 loc(#loc491)
    %qk_474 = tt.dot %q_pe, %k_pe_472, %qk_471 : tensor<64x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x32xf32, #mma> loc(#loc491)
    %qk_475 = tt.splat %sm_scale : f32 -> tensor<64x32xf32, #mma> loc(#loc492)
    %qk_476 = arith.mulf %qk_474, %qk_475 : tensor<64x32xf32, #mma> loc(#loc492)
    %offs_n_qk = arith.constant 2 : i32 loc(#loc493)
    %offs_n_qk_477 = arith.constant 2 : i32 loc(#loc493)
    %offs_n_qk_478 = arith.extsi %num_iter : i32 to i64 loc(#loc493)
    %offs_n_qk_479 = arith.extsi %offs_n_qk_477 : i32 to i64 loc(#loc493)
    %offs_n_qk_480 = arith.subi %offs_n_qk_478, %offs_n_qk_479 : i64 loc(#loc493)
    %offs_n_qk_481 = arith.constant 2147483647 : i64 loc(#loc493)
    %offs_n_qk_482 = arith.constant -2147483648 : i64 loc(#loc493)
    %offs_n_qk_483 = arith.cmpi sle, %offs_n_qk_480, %offs_n_qk_481 : i64 loc(#loc493)
    %offs_n_qk_484 = arith.cmpi sge, %offs_n_qk_480, %offs_n_qk_482 : i64 loc(#loc493)
    %offs_n_qk_485 = arith.andi %offs_n_qk_483, %offs_n_qk_484 : i1 loc(#loc493)
    %offs_n_qk_486 = arith.subi %num_iter, %offs_n_qk_477 : i32 loc(#loc493)
    %offs_n_qk_487 = arith.constant 32 : i32 loc(#loc494)
    %offs_n_qk_488 = arith.constant 32 : i32 loc(#loc494)
    %offs_n_qk_489 = arith.extsi %offs_n_qk_486 : i32 to i64 loc(#loc494)
    %offs_n_qk_490 = arith.extsi %offs_n_qk_488 : i32 to i64 loc(#loc494)
    %offs_n_qk_491 = arith.muli %offs_n_qk_489, %offs_n_qk_490 : i64 loc(#loc494)
    %offs_n_qk_492 = arith.constant 2147483647 : i64 loc(#loc494)
    %offs_n_qk_493 = arith.constant -2147483648 : i64 loc(#loc494)
    %offs_n_qk_494 = arith.cmpi sle, %offs_n_qk_491, %offs_n_qk_492 : i64 loc(#loc494)
    %offs_n_qk_495 = arith.cmpi sge, %offs_n_qk_491, %offs_n_qk_493 : i64 loc(#loc494)
    %offs_n_qk_496 = arith.andi %offs_n_qk_494, %offs_n_qk_495 : i1 loc(#loc494)
    %offs_n_qk_497 = arith.muli %offs_n_qk_486, %offs_n_qk_488 : i32 loc(#loc494)
    %offs_n_qk_498 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc495)
    %offs_n_qk_499 = tt.splat %offs_n_qk_497 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_500 = arith.extsi %offs_n_qk_499 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_501 = arith.extsi %offs_n_qk_498 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_502 = arith.addi %offs_n_qk_500, %offs_n_qk_501 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_503 = arith.constant 2147483647 : i64 loc(#loc496)
    %offs_n_qk_504 = arith.constant -2147483648 : i64 loc(#loc496)
    %offs_n_qk_505 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_506 = arith.cmpi sle, %offs_n_qk_502, %offs_n_qk_505 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_507 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_508 = arith.cmpi sge, %offs_n_qk_502, %offs_n_qk_507 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_509 = arith.andi %offs_n_qk_506, %offs_n_qk_508 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %offs_n_qk_510 = arith.addi %offs_n_qk_499, %offs_n_qk_498 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc496)
    %qk_511 = tt.expand_dims %offs_n_qk_510 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc497)
    %qk_512 = tt.splat %cur_batch_seq_len_0 : i32 -> tensor<1x32xi32, #mma> loc(#loc498)
    %qk_513 = arith.cmpi slt, %qk_511, %qk_512 : tensor<1x32xi32, #mma> loc(#loc498)
    %qk_514 = arith.constant 0xFF800000 : f32 loc(#loc499)
    %qk_515 = arith.constant 0xFF800000 : f32 loc(#loc499)
    %qk_516 = arith.constant dense<0xFF800000> : tensor<64x32xf32, #mma> loc(#loc499)
    %qk_517 = tt.broadcast %qk_513 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc499)
    %qk_518 = arith.select %qk_517, %qk_476, %qk_516 : tensor<64x32xi1, #mma>, tensor<64x32xf32, #mma> loc(#loc499)
    %n_e_max = tt.call @triton.language.standard.max__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cTrue_cFalse(%qk_518) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc500)
    %n_e_max_519 = arith.maxnumf %n_e_max, %buf_idx_320#0 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc501)
    %re_scale = arith.subf %buf_idx_320#0, %n_e_max_519 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc502)
    %re_scale_520 = math.exp %re_scale : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc503)
    %p = tt.expand_dims %n_e_max_519 {axis = 1 : i32} : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xf32, #mma> loc(#loc504)
    %p_521 = tt.broadcast %p : tensor<64x1xf32, #mma> -> tensor<64x32xf32, #mma> loc(#loc505)
    %p_522 = arith.subf %qk_518, %p_521 : tensor<64x32xf32, #mma> loc(#loc505)
    %p_523 = math.exp %p_522 : tensor<64x32xf32, #mma> loc(#loc506)
    %e_sum_524 = arith.mulf %buf_idx_320#1, %re_scale_520 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc507)
    %e_sum_525 = tt.call @triton.language.standard.sum__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cNone(%p_523) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc508)
    %e_sum_526 = arith.addf %e_sum_524, %e_sum_525 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc509)
    %p_527 = arith.truncf %p_523 : tensor<64x32xf32, #mma> to tensor<64x32xbf16, #mma> loc(#loc510)
    %p_528 = ttg.convert_layout %p_527 : tensor<64x32xbf16, #mma> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> loc(#loc511)
    %acc_529 = tt.expand_dims %re_scale_520 {axis = 1 : i32} : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xf32, #mma> loc(#loc512)
    %acc_530 = tt.broadcast %acc_529 : tensor<64x1xf32, #mma> -> tensor<64x512xf32, #mma> loc(#loc513)
    %acc_531 = arith.mulf %buf_idx_320#2, %acc_530 : tensor<64x512xf32, #mma> loc(#loc513)
    %v_c = ttg.memdesc_index %bufs_kv[%buf_idx_320#13] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc514)
    %v_c_532 = ttg.local_load %v_c : !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> -> tensor<512x32xbf16, #linear2> loc(#loc515)
    %v_c_533 = tt.trans %v_c_532 {order = array<i32: 1, 0>} : tensor<512x32xbf16, #linear2> -> tensor<32x512xbf16, #linear3> loc(#loc516)
    %v_c_534 = ttg.convert_layout %v_c_533 : tensor<32x512xbf16, #linear3> -> tensor<32x512xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc517)
    %acc_535 = arith.constant 0.000000e+00 : f32 loc(#loc518)
    %acc_536 = tt.dot %p_528, %v_c_534, %acc_531 : tensor<64x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<32x512xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x512xf32, #mma> loc(#loc518)
    %buf_idx_537 = arith.constant 1 : i32 loc(#loc519)
    %buf_idx_538 = arith.constant 1 : i32 loc(#loc519)
    %buf_idx_539 = arith.extsi %buf_idx_320#13 : i32 to i64 loc(#loc519)
    %buf_idx_540 = arith.extsi %buf_idx_538 : i32 to i64 loc(#loc519)
    %buf_idx_541 = arith.addi %buf_idx_539, %buf_idx_540 : i64 loc(#loc519)
    %buf_idx_542 = arith.constant 2147483647 : i64 loc(#loc519)
    %buf_idx_543 = arith.constant -2147483648 : i64 loc(#loc519)
    %buf_idx_544 = arith.cmpi sle, %buf_idx_541, %buf_idx_542 : i64 loc(#loc519)
    %buf_idx_545 = arith.cmpi sge, %buf_idx_541, %buf_idx_543 : i64 loc(#loc519)
    %buf_idx_546 = arith.andi %buf_idx_544, %buf_idx_545 : i1 loc(#loc519)
    %buf_idx_547 = arith.addi %buf_idx_320#13, %buf_idx_538 : i32 loc(#loc519)
    %buf_idx_548 = arith.constant 2 : i32 loc(#loc520)
    %buf_idx_549 = arith.constant 2 : i32 loc(#loc520)
    %buf_idx_550 = arith.remsi %buf_idx_547, %buf_idx_549 : i32 loc(#loc520)
    %47 = ttg.async_wait {num = 1 : i32} loc(#loc233)
    %k_c_551 = ttg.memdesc_index %bufs_kv[%buf_idx_550] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc521)
    %k_c_552 = ttg.local_load %k_c_551 : !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> -> tensor<512x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc522)
    %zeros_553 = tt.call @triton.experimental.gluon.language._standard.zeros__Tc64_c32T_cfp32_cMFMA_4_16_16_32_True_4_1_32_1_1__MFMA() : () -> tensor<64x32xf32, #mma> loc(#loc523)
    %qk_554 = arith.constant 0.000000e+00 : f32 loc(#loc524)
    %qk_555 = tt.dot %q_nope, %k_c_552, %zeros_553 : tensor<64x512xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<512x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x32xf32, #mma> loc(#loc524)
    %48 = ttg.async_wait {num = 0 : i32} loc(#loc238)
    %k_pe_556 = ttg.memdesc_index %bufs_kpe[%buf_idx_550] : !ttg.memdesc<2x64x32xbf16, #shared3, #smem, mutable> -> !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> loc(#loc525)
    %k_pe_557 = ttg.local_load %k_pe_556 : !ttg.memdesc<64x32xbf16, #shared3, #smem, mutable> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc526)
    %qk_558 = arith.constant 0.000000e+00 : f32 loc(#loc527)
    %qk_559 = tt.dot %q_pe, %k_pe_557, %qk_555 : tensor<64x64xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<64x32xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x32xf32, #mma> loc(#loc527)
    %qk_560 = tt.splat %sm_scale : f32 -> tensor<64x32xf32, #mma> loc(#loc528)
    %qk_561 = arith.mulf %qk_559, %qk_560 : tensor<64x32xf32, #mma> loc(#loc528)
    %offs_n_qk_562 = arith.constant 1 : i32 loc(#loc529)
    %offs_n_qk_563 = arith.constant 1 : i32 loc(#loc529)
    %offs_n_qk_564 = arith.extsi %num_iter : i32 to i64 loc(#loc529)
    %offs_n_qk_565 = arith.extsi %offs_n_qk_563 : i32 to i64 loc(#loc529)
    %offs_n_qk_566 = arith.subi %offs_n_qk_564, %offs_n_qk_565 : i64 loc(#loc529)
    %offs_n_qk_567 = arith.constant 2147483647 : i64 loc(#loc529)
    %offs_n_qk_568 = arith.constant -2147483648 : i64 loc(#loc529)
    %offs_n_qk_569 = arith.cmpi sle, %offs_n_qk_566, %offs_n_qk_567 : i64 loc(#loc529)
    %offs_n_qk_570 = arith.cmpi sge, %offs_n_qk_566, %offs_n_qk_568 : i64 loc(#loc529)
    %offs_n_qk_571 = arith.andi %offs_n_qk_569, %offs_n_qk_570 : i1 loc(#loc529)
    %offs_n_qk_572 = arith.subi %num_iter, %offs_n_qk_563 : i32 loc(#loc529)
    %offs_n_qk_573 = arith.constant 32 : i32 loc(#loc530)
    %offs_n_qk_574 = arith.constant 32 : i32 loc(#loc530)
    %offs_n_qk_575 = arith.extsi %offs_n_qk_572 : i32 to i64 loc(#loc530)
    %offs_n_qk_576 = arith.extsi %offs_n_qk_574 : i32 to i64 loc(#loc530)
    %offs_n_qk_577 = arith.muli %offs_n_qk_575, %offs_n_qk_576 : i64 loc(#loc530)
    %offs_n_qk_578 = arith.constant 2147483647 : i64 loc(#loc530)
    %offs_n_qk_579 = arith.constant -2147483648 : i64 loc(#loc530)
    %offs_n_qk_580 = arith.cmpi sle, %offs_n_qk_577, %offs_n_qk_578 : i64 loc(#loc530)
    %offs_n_qk_581 = arith.cmpi sge, %offs_n_qk_577, %offs_n_qk_579 : i64 loc(#loc530)
    %offs_n_qk_582 = arith.andi %offs_n_qk_580, %offs_n_qk_581 : i1 loc(#loc530)
    %offs_n_qk_583 = arith.muli %offs_n_qk_572, %offs_n_qk_574 : i32 loc(#loc530)
    %offs_n_qk_584 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc531)
    %offs_n_qk_585 = tt.splat %offs_n_qk_583 : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_586 = arith.extsi %offs_n_qk_585 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_587 = arith.extsi %offs_n_qk_584 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> to tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_588 = arith.addi %offs_n_qk_586, %offs_n_qk_587 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_589 = arith.constant 2147483647 : i64 loc(#loc532)
    %offs_n_qk_590 = arith.constant -2147483648 : i64 loc(#loc532)
    %offs_n_qk_591 = arith.constant dense<2147483647> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_592 = arith.cmpi sle, %offs_n_qk_588, %offs_n_qk_591 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_593 = arith.constant dense<-2147483648> : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_594 = arith.cmpi sge, %offs_n_qk_588, %offs_n_qk_593 : tensor<32xi64, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_595 = arith.andi %offs_n_qk_592, %offs_n_qk_594 : tensor<32xi1, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %offs_n_qk_596 = arith.addi %offs_n_qk_585, %offs_n_qk_584 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc532)
    %qk_597 = tt.expand_dims %offs_n_qk_596 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc533)
    %qk_598 = tt.splat %cur_batch_seq_len_0 : i32 -> tensor<1x32xi32, #mma> loc(#loc534)
    %qk_599 = arith.cmpi slt, %qk_597, %qk_598 : tensor<1x32xi32, #mma> loc(#loc534)
    %qk_600 = arith.constant 0xFF800000 : f32 loc(#loc535)
    %qk_601 = arith.constant 0xFF800000 : f32 loc(#loc535)
    %qk_602 = arith.constant dense<0xFF800000> : tensor<64x32xf32, #mma> loc(#loc535)
    %qk_603 = tt.broadcast %qk_599 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc535)
    %qk_604 = arith.select %qk_603, %qk_561, %qk_602 : tensor<64x32xi1, #mma>, tensor<64x32xf32, #mma> loc(#loc535)
    %n_e_max_605 = tt.call @triton.language.standard.max__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cTrue_cFalse(%qk_604) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc536)
    %n_e_max_606 = arith.maxnumf %n_e_max_605, %n_e_max_519 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc537)
    %re_scale_607 = arith.subf %n_e_max_519, %n_e_max_606 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc538)
    %re_scale_608 = math.exp %re_scale_607 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc539)
    %p_609 = tt.expand_dims %n_e_max_606 {axis = 1 : i32} : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xf32, #mma> loc(#loc540)
    %p_610 = tt.broadcast %p_609 : tensor<64x1xf32, #mma> -> tensor<64x32xf32, #mma> loc(#loc541)
    %p_611 = arith.subf %qk_604, %p_610 : tensor<64x32xf32, #mma> loc(#loc541)
    %p_612 = math.exp %p_611 : tensor<64x32xf32, #mma> loc(#loc542)
    %e_sum_613 = arith.mulf %e_sum_526, %re_scale_608 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc543)
    %e_sum_614 = tt.call @triton.language.standard.sum__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cNone(%p_612) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc544)
    %e_sum_615 = arith.addf %e_sum_613, %e_sum_614 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc545)
    %p_616 = arith.truncf %p_612 : tensor<64x32xf32, #mma> to tensor<64x32xbf16, #mma> loc(#loc546)
    %p_617 = ttg.convert_layout %p_616 : tensor<64x32xbf16, #mma> -> tensor<64x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> loc(#loc547)
    %acc_618 = tt.expand_dims %re_scale_608 {axis = 1 : i32} : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xf32, #mma> loc(#loc548)
    %acc_619 = tt.broadcast %acc_618 : tensor<64x1xf32, #mma> -> tensor<64x512xf32, #mma> loc(#loc549)
    %acc_620 = arith.mulf %acc_536, %acc_619 : tensor<64x512xf32, #mma> loc(#loc549)
    %v_c_621 = ttg.memdesc_index %bufs_kv[%buf_idx_550] : !ttg.memdesc<2x512x32xbf16, #shared2, #smem, mutable> -> !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> loc(#loc550)
    %v_c_622 = ttg.local_load %v_c_621 : !ttg.memdesc<512x32xbf16, #shared2, #smem, mutable> -> tensor<512x32xbf16, #linear2> loc(#loc551)
    %v_c_623 = tt.trans %v_c_622 {order = array<i32: 1, 0>} : tensor<512x32xbf16, #linear2> -> tensor<32x512xbf16, #linear3> loc(#loc552)
    %v_c_624 = ttg.convert_layout %v_c_623 : tensor<32x512xbf16, #linear3> -> tensor<32x512xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> loc(#loc553)
    %acc_625 = arith.constant 0.000000e+00 : f32 loc(#loc554)
    %acc_626 = tt.dot %p_617, %v_c_624, %acc_620 : tensor<64x32xbf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 8}>> * tensor<32x512xbf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 8}>> -> tensor<64x512xf32, #mma> loc(#loc554)
    %cur_head_o = arith.constant 64 : i32 loc(#loc555)
    %cur_head_o_627 = arith.constant 64 : i32 loc(#loc555)
    %cur_head_o_628 = arith.extsi %cur_head_id : i32 to i64 loc(#loc555)
    %cur_head_o_629 = arith.extsi %cur_head_o_627 : i32 to i64 loc(#loc555)
    %cur_head_o_630 = arith.muli %cur_head_o_628, %cur_head_o_629 : i64 loc(#loc555)
    %cur_head_o_631 = arith.constant 2147483647 : i64 loc(#loc555)
    %cur_head_o_632 = arith.constant -2147483648 : i64 loc(#loc555)
    %cur_head_o_633 = arith.cmpi sle, %cur_head_o_630, %cur_head_o_631 : i64 loc(#loc555)
    %cur_head_o_634 = arith.cmpi sge, %cur_head_o_630, %cur_head_o_632 : i64 loc(#loc555)
    %cur_head_o_635 = arith.andi %cur_head_o_633, %cur_head_o_634 : i1 loc(#loc555)
    %cur_head_o_636 = arith.muli %cur_head_id, %cur_head_o_627 : i32 loc(#loc555)
    %cur_head_o_637 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc556)
    %cur_head_o_638 = tt.splat %cur_head_o_636 : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_639 = arith.extsi %cur_head_o_638 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_640 = arith.extsi %cur_head_o_637 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> to tensor<64xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_641 = arith.addi %cur_head_o_639, %cur_head_o_640 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_642 = arith.constant 2147483647 : i64 loc(#loc557)
    %cur_head_o_643 = arith.constant -2147483648 : i64 loc(#loc557)
    %cur_head_o_644 = arith.constant dense<2147483647> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_645 = arith.cmpi sle, %cur_head_o_641, %cur_head_o_644 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_646 = arith.constant dense<-2147483648> : tensor<64xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_647 = arith.cmpi sge, %cur_head_o_641, %cur_head_o_646 : tensor<64xi64, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_648 = arith.andi %cur_head_o_645, %cur_head_o_647 : tensor<64xi1, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %cur_head_o_649 = arith.addi %cur_head_o_638, %cur_head_o_637 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc557)
    %offs_d_ckv_o = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc558)
    %offs_o = arith.extsi %cur_batch : i32 to i64 loc(#loc559)
    %offs_o_650 = arith.extsi %stride_o_b : i32 to i64 loc(#loc559)
    %offs_o_651 = arith.muli %offs_o, %offs_o_650 : i64 loc(#loc559)
    %offs_o_652 = arith.constant 2147483647 : i64 loc(#loc559)
    %offs_o_653 = arith.constant -2147483648 : i64 loc(#loc559)
    %offs_o_654 = arith.cmpi sle, %offs_o_651, %offs_o_652 : i64 loc(#loc559)
    %offs_o_655 = arith.cmpi sge, %offs_o_651, %offs_o_653 : i64 loc(#loc559)
    %offs_o_656 = arith.andi %offs_o_654, %offs_o_655 : i1 loc(#loc559)
    %offs_o_657 = arith.muli %cur_batch, %stride_o_b : i32 loc(#loc559)
    %offs_o_658 = tt.expand_dims %cur_head_o_649 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc560)
    %offs_o_659 = tt.splat %stride_o_h : i32 -> tensor<64x1xi32, #mma> loc(#loc561)
    %offs_o_660 = arith.extsi %offs_o_658 : tensor<64x1xi32, #mma> to tensor<64x1xi64, #mma> loc(#loc561)
    %offs_o_661 = arith.extsi %offs_o_659 : tensor<64x1xi32, #mma> to tensor<64x1xi64, #mma> loc(#loc561)
    %offs_o_662 = arith.muli %offs_o_660, %offs_o_661 : tensor<64x1xi64, #mma> loc(#loc561)
    %offs_o_663 = arith.constant 2147483647 : i64 loc(#loc561)
    %offs_o_664 = arith.constant -2147483648 : i64 loc(#loc561)
    %offs_o_665 = arith.constant dense<2147483647> : tensor<64x1xi64, #mma> loc(#loc561)
    %offs_o_666 = arith.cmpi sle, %offs_o_662, %offs_o_665 : tensor<64x1xi64, #mma> loc(#loc561)
    %offs_o_667 = arith.constant dense<-2147483648> : tensor<64x1xi64, #mma> loc(#loc561)
    %offs_o_668 = arith.cmpi sge, %offs_o_662, %offs_o_667 : tensor<64x1xi64, #mma> loc(#loc561)
    %offs_o_669 = arith.andi %offs_o_666, %offs_o_668 : tensor<64x1xi1, #mma> loc(#loc561)
    %offs_o_670 = arith.muli %offs_o_658, %offs_o_659 : tensor<64x1xi32, #mma> loc(#loc561)
    %offs_o_671 = tt.splat %offs_o_657 : i32 -> tensor<64x1xi32, #mma> loc(#loc562)
    %offs_o_672 = arith.extsi %offs_o_671 : tensor<64x1xi32, #mma> to tensor<64x1xi64, #mma> loc(#loc562)
    %offs_o_673 = arith.extsi %offs_o_670 : tensor<64x1xi32, #mma> to tensor<64x1xi64, #mma> loc(#loc562)
    %offs_o_674 = arith.addi %offs_o_672, %offs_o_673 : tensor<64x1xi64, #mma> loc(#loc562)
    %offs_o_675 = arith.constant 2147483647 : i64 loc(#loc562)
    %offs_o_676 = arith.constant -2147483648 : i64 loc(#loc562)
    %offs_o_677 = arith.constant dense<2147483647> : tensor<64x1xi64, #mma> loc(#loc562)
    %offs_o_678 = arith.cmpi sle, %offs_o_674, %offs_o_677 : tensor<64x1xi64, #mma> loc(#loc562)
    %offs_o_679 = arith.constant dense<-2147483648> : tensor<64x1xi64, #mma> loc(#loc562)
    %offs_o_680 = arith.cmpi sge, %offs_o_674, %offs_o_679 : tensor<64x1xi64, #mma> loc(#loc562)
    %offs_o_681 = arith.andi %offs_o_678, %offs_o_680 : tensor<64x1xi1, #mma> loc(#loc562)
    %offs_o_682 = arith.addi %offs_o_671, %offs_o_670 : tensor<64x1xi32, #mma> loc(#loc562)
    %offs_o_683 = arith.extsi %split_kv_id : i32 to i64 loc(#loc563)
    %offs_o_684 = arith.extsi %stride_o_s : i32 to i64 loc(#loc563)
    %offs_o_685 = arith.muli %offs_o_683, %offs_o_684 : i64 loc(#loc563)
    %offs_o_686 = arith.constant 2147483647 : i64 loc(#loc563)
    %offs_o_687 = arith.constant -2147483648 : i64 loc(#loc563)
    %offs_o_688 = arith.cmpi sle, %offs_o_685, %offs_o_686 : i64 loc(#loc563)
    %offs_o_689 = arith.cmpi sge, %offs_o_685, %offs_o_687 : i64 loc(#loc563)
    %offs_o_690 = arith.andi %offs_o_688, %offs_o_689 : i1 loc(#loc563)
    %offs_o_691 = arith.muli %split_kv_id, %stride_o_s : i32 loc(#loc563)
    %offs_o_692 = tt.splat %offs_o_691 : i32 -> tensor<64x1xi32, #mma> loc(#loc564)
    %offs_o_693 = arith.extsi %offs_o_682 : tensor<64x1xi32, #mma> to tensor<64x1xi64, #mma> loc(#loc564)
    %offs_o_694 = arith.extsi %offs_o_692 : tensor<64x1xi32, #mma> to tensor<64x1xi64, #mma> loc(#loc564)
    %offs_o_695 = arith.addi %offs_o_693, %offs_o_694 : tensor<64x1xi64, #mma> loc(#loc564)
    %offs_o_696 = arith.constant 2147483647 : i64 loc(#loc564)
    %offs_o_697 = arith.constant -2147483648 : i64 loc(#loc564)
    %offs_o_698 = arith.constant dense<2147483647> : tensor<64x1xi64, #mma> loc(#loc564)
    %offs_o_699 = arith.cmpi sle, %offs_o_695, %offs_o_698 : tensor<64x1xi64, #mma> loc(#loc564)
    %offs_o_700 = arith.constant dense<-2147483648> : tensor<64x1xi64, #mma> loc(#loc564)
    %offs_o_701 = arith.cmpi sge, %offs_o_695, %offs_o_700 : tensor<64x1xi64, #mma> loc(#loc564)
    %offs_o_702 = arith.andi %offs_o_699, %offs_o_701 : tensor<64x1xi1, #mma> loc(#loc564)
    %offs_o_703 = arith.addi %offs_o_682, %offs_o_692 : tensor<64x1xi32, #mma> loc(#loc564)
    %offs_o_704 = tt.expand_dims %offs_d_ckv_o {axis = 0 : i32} : tensor<512xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x512xi32, #mma> loc(#loc565)
    %offs_o_705 = tt.broadcast %offs_o_703 : tensor<64x1xi32, #mma> -> tensor<64x512xi32, #mma> loc(#loc566)
    %offs_o_706 = tt.broadcast %offs_o_704 : tensor<1x512xi32, #mma> -> tensor<64x512xi32, #mma> loc(#loc566)
    %offs_o_707 = arith.extsi %offs_o_705 : tensor<64x512xi32, #mma> to tensor<64x512xi64, #mma> loc(#loc566)
    %offs_o_708 = arith.extsi %offs_o_706 : tensor<64x512xi32, #mma> to tensor<64x512xi64, #mma> loc(#loc566)
    %offs_o_709 = arith.addi %offs_o_707, %offs_o_708 : tensor<64x512xi64, #mma> loc(#loc566)
    %offs_o_710 = arith.constant 2147483647 : i64 loc(#loc566)
    %offs_o_711 = arith.constant -2147483648 : i64 loc(#loc566)
    %offs_o_712 = arith.constant dense<2147483647> : tensor<64x512xi64, #mma> loc(#loc566)
    %offs_o_713 = arith.cmpi sle, %offs_o_709, %offs_o_712 : tensor<64x512xi64, #mma> loc(#loc566)
    %offs_o_714 = arith.constant dense<-2147483648> : tensor<64x512xi64, #mma> loc(#loc566)
    %offs_o_715 = arith.cmpi sge, %offs_o_709, %offs_o_714 : tensor<64x512xi64, #mma> loc(#loc566)
    %offs_o_716 = arith.andi %offs_o_713, %offs_o_715 : tensor<64x512xi1, #mma> loc(#loc566)
    %offs_o_717 = arith.addi %offs_o_705, %offs_o_706 : tensor<64x512xi32, #mma> loc(#loc566)
    %rcp = arith.constant 1.000000e+00 : f32 loc(#loc567)
    %rcp_718 = arith.constant 1.000000e+00 : f32 loc(#loc567)
    %rcp_719 = arith.constant dense<1.000000e+00> : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc567)
    %rcp_720 = arith.divf %rcp_719, %e_sum_615 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc567)
    %stored_value = tt.expand_dims %rcp_720 {axis = 1 : i32} : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xf32, #mma> loc(#loc568)
    %stored_value_721 = tt.broadcast %stored_value : tensor<64x1xf32, #mma> -> tensor<64x512xf32, #mma> loc(#loc569)
    %stored_value_722 = arith.mulf %acc_626, %stored_value_721 : tensor<64x512xf32, #mma> loc(#loc569)
    %stored_value_723 = arith.truncf %stored_value_722 : tensor<64x512xf32, #mma> to tensor<64x512xbf16, #mma> loc(#loc570)
    amdg.buffer_store %stored_value_723, %O[%offs_o_717] : tensor<64x512xbf16, #mma> loc(#loc285)
    tt.return loc(#loc286)
  } loc(#loc1)
  tt.func private @triton.experimental.gluon.language._standard.zeros__Tc64T_cfp32_cSL1_MFMA_4_16_16_32_True_4_1_32_1_1__MFMASL() -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc288)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc288)
    tt.return %cst_0 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc289)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc290)
    tt.return %0 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc290)
  } loc(#loc287)
  tt.func private @triton.experimental.gluon.language._standard.zeros__Tc64_c512T_cfp32_cMFMA_4_16_16_32_True_4_1_32_1_1__MFMA() -> tensor<64x512xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc288)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x512xf32, #mma> loc(#loc288)
    tt.return %cst_0 : tensor<64x512xf32, #mma> loc(#loc289)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<64x512xf32, #mma> loc(#loc290)
    tt.return %0 : tensor<64x512xf32, #mma> loc(#loc290)
  } loc(#loc287)
  tt.func private @triton.language.standard.cdiv__i32_c32(%x: i32 loc("x"(#loc291))) -> i32 attributes {noinline = false} {
    %c31_i32 = arith.constant 31 : i32 loc(#loc292)
    %c31_i32_0 = arith.constant 31 : i32 loc(#loc292)
    %0 = arith.extsi %x : i32 to i64 loc(#loc292)
    %1 = arith.extsi %c31_i32_0 : i32 to i64 loc(#loc292)
    %2 = arith.addi %0, %1 : i64 loc(#loc292)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc292)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc292)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc292)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc292)
    %5 = arith.andi %3, %4 : i1 loc(#loc292)
    %6 = arith.addi %x, %c31_i32_0 : i32 loc(#loc292)
    %c32_i32 = arith.constant 32 : i32 loc(#loc293)
    %c32_i32_1 = arith.constant 32 : i32 loc(#loc293)
    %7 = arith.divsi %6, %c32_i32_1 : i32 loc(#loc293)
    tt.return %7 : i32 loc(#loc294)
  ^bb1:  // no predecessors
    %8 = ub.poison : i32 loc(#loc295)
    tt.return %8 : i32 loc(#loc295)
  } loc(#loc291)
  tt.func private @triton.experimental.gluon.language._standard.zeros__Tc64_c32T_cfp32_cMFMA_4_16_16_32_True_4_1_32_1_1__MFMA() -> tensor<64x32xf32, #mma> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc288)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc288)
    tt.return %cst_0 : tensor<64x32xf32, #mma> loc(#loc289)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<64x32xf32, #mma> loc(#loc290)
    tt.return %0 : tensor<64x32xf32, #mma> loc(#loc290)
  } loc(#loc287)
  tt.func private @triton.language.standard.max__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cTrue_cFalse(%input: tensor<64x32xf32, #mma> loc("input"(#loc296))) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._elementwise_max__fp32_fp32(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc297)
      tt.reduce.return %2 : f32 loc(#loc297)
    }) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc297)
    tt.return %0 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc298)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc299)
    tt.return %1 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc299)
  } loc(#loc296)
  tt.func private @triton.language.standard._elementwise_max__fp32_fp32(%a: f32 loc("a"(#loc300)), %b: f32 loc("b"(#loc300))) -> f32 attributes {noinline = false} {
    %0 = arith.maxnumf %a, %b : f32 loc(#loc301)
    tt.return %0 : f32 loc(#loc302)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc303)
    tt.return %1 : f32 loc(#loc303)
  } loc(#loc300)
  tt.func private @triton.language.standard.sum__fp32S64_32SLMFMA_4_16_16_32_True_4_1_32_1_1__MFMAL_c1_cFalse_cNone(%input: tensor<64x32xf32, #mma> loc("input"(#loc304))) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> attributes {noinline = false} {
    %0 = "tt.reduce"(%input) <{axis = 1 : i32}> ({
    ^bb0(%arg1: f32 loc(unknown), %arg2: f32 loc(unknown)):
      %2 = tt.call @triton.language.standard._sum_combine__fp32_fp32(%arg1, %arg2) : (f32, f32) -> f32 loc(#loc305)
      tt.reduce.return %2 : f32 loc(#loc305)
    }) : (tensor<64x32xf32, #mma>) -> tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc305)
    tt.return %0 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc306)
  ^bb1:  // no predecessors
    %1 = ub.poison : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc307)
    tt.return %1 : tensor<64xf32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc307)
  } loc(#loc304)
  tt.func private @triton.language.standard._sum_combine__fp32_fp32(%a: f32 loc("a"(#loc308)), %b: f32 loc("b"(#loc308))) -> f32 attributes {noinline = false} {
    %0 = arith.addf %a, %b : f32 loc(#loc309)
    tt.return %0 : f32 loc(#loc310)
  ^bb1:  // no predecessors
    %1 = ub.poison : f32 loc(#loc311)
    tt.return %1 : f32 loc(#loc311)
  } loc(#loc308)
} loc(#loc)
#loc2 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":254:30)
#loc3 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":255:32)
#loc4 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":256:32)
#loc5 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":258:44)
#loc6 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":258:32)
#loc7 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":292:43)
#loc8 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":293:41)
#loc9 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":320:40)
#loc10 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":321:41)
#loc11 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":349:30)
#loc12 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":350:29)
#loc13 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":350:52)
#loc14 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":350:39)
#loc15 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":351:30)
#loc16 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":351:58)
#loc17 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":351:69)
#loc18 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":351:49)
#loc19 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":351:98)
#loc20 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":351:87)
#loc21 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":352:70)
#loc22 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":353:4)
#loc23 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":356:30)
#loc24 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":357:33)
#loc25 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":357:56)
#loc26 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":357:43)
#loc27 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":358:28)
#loc28 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":358:58)
#loc29 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":358:69)
#loc30 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":358:45)
#loc31 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":358:96)
#loc32 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":358:85)
#loc33 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":359:66)
#loc34 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":360:4)
#loc35 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":362:21)
#loc36 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":362:91)
#loc37 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":363:21)
#loc38 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":364:19)
#loc39 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":371:37)
#loc40 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":372:14)
#loc41 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":377:50)
#loc42 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":377:24)
#loc43 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":377:73)
#loc44 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":377:62)
#loc45 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":377:8)
#loc46 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":381:39)
#loc47 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":382:29)
#loc48 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":383:39)
#loc49 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":384:25)
#loc50 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":387:36)
#loc51 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":387:23)
#loc52 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":388:30)
#loc53 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":388:51)
#loc54 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":388:42)
#loc55 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":389:32)
#loc56 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":390:22)
#loc57 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":390:33)
#loc58 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":390:63)
#loc59 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":390:50)
#loc60 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":391:64)
#loc61 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":391:80)
#loc62 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":392:4)
#loc63 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":395:39)
#loc64 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":395:26)
#loc65 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":396:33)
#loc66 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":396:57)
#loc67 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":396:45)
#loc68 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":397:32)
#loc69 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":398:26)
#loc70 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":398:37)
#loc71 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":398:67)
#loc72 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":398:54)
#loc73 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":399:65)
#loc74 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":399:81)
#loc75 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":400:4)
#loc76 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":402:15)
#loc77 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":406:50)
#loc78 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":406:24)
#loc79 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":406:73)
#loc80 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":406:62)
#loc81 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":406:8)
#loc82 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":409:25)
#loc83 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":409:14)
#loc84 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":410:14)
#loc85 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":412:30)
#loc86 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":412:19)
#loc87 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":414:31)
#loc88 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":414:36)
#loc89 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":417:40)
#loc90 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":417:27)
#loc91 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":418:34)
#loc92 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":418:55)
#loc93 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":418:46)
#loc94 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":419:36)
#loc95 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":420:26)
#loc96 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":420:37)
#loc97 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":420:67)
#loc98 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":420:54)
#loc99 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":421:114)
#loc100 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":421:125)
#loc101 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":421:68)
#loc102 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":421:92)
#loc103 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":422:8)
#loc104 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":425:43)
#loc105 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":425:30)
#loc106 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":426:37)
#loc107 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":426:61)
#loc108 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":426:49)
#loc109 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":427:36)
#loc110 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":428:30)
#loc111 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":428:41)
#loc112 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":428:71)
#loc113 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":428:58)
#loc114 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":429:119)
#loc115 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":429:130)
#loc116 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":429:69)
#loc117 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":429:93)
#loc118 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":430:8)
#loc119 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":432:19)
#loc120 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":436:54)
#loc121 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":436:28)
#loc122 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":436:77)
#loc123 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":436:66)
#loc124 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":436:12)
#loc125 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":440:43)
#loc126 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":441:28)
#loc127 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":441:42)
#loc128 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":442:25)
#loc129 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":443:61)
#loc130 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":445:43)
#loc131 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":446:30)
#loc132 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":446:44)
#loc133 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":447:58)
#loc134 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":448:14)
#loc135 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":450:24)
#loc136 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":450:47)
#loc137 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":450:34)
#loc138 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":451:32)
#loc139 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":451:43)
#loc140 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":451:61)
#loc141 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":452:40)
#loc142 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":452:44)
#loc143 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":453:34)
#loc144 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":453:26)
#loc145 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":454:32)
#loc146 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":454:24)
#loc147 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":454:19)
#loc148 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":456:24)
#loc149 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":456:45)
#loc150 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":456:35)
#loc151 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":459:17)
#loc152 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":460:33)
#loc153 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":461:24)
#loc154 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":461:15)
#loc155 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":462:28)
#loc156 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":462:42)
#loc157 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":464:30)
#loc158 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":465:37)
#loc159 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":466:40)
#loc160 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":469:29)
#loc161 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":469:34)
#loc162 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":469:8)
#loc163 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":473:27)
#loc164 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":473:32)
#loc165 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":475:36)
#loc166 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":475:23)
#loc167 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":476:30)
#loc168 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":476:51)
#loc169 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":476:42)
#loc170 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":477:32)
#loc171 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":478:22)
#loc172 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":478:33)
#loc173 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":478:63)
#loc174 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":478:50)
#loc175 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":479:110)
#loc176 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":479:121)
#loc177 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":479:64)
#loc178 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":479:88)
#loc179 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":480:4)
#loc180 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":483:39)
#loc181 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":483:26)
#loc182 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":484:33)
#loc183 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":484:57)
#loc184 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":484:45)
#loc185 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":485:32)
#loc186 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":486:26)
#loc187 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":486:37)
#loc188 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":486:67)
#loc189 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":486:54)
#loc190 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":487:115)
#loc191 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":487:126)
#loc192 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":487:65)
#loc193 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":487:89)
#loc194 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":488:4)
#loc195 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":492:39)
#loc196 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":493:24)
#loc197 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":493:38)
#loc198 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":494:21)
#loc199 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":495:57)
#loc200 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":497:39)
#loc201 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":498:26)
#loc202 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":498:40)
#loc203 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":499:54)
#loc204 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":500:10)
#loc205 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":502:28)
#loc206 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":502:33)
#loc207 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":502:56)
#loc208 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":502:43)
#loc209 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":503:28)
#loc210 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":503:39)
#loc211 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":503:57)
#loc212 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":504:36)
#loc213 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":504:40)
#loc214 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":505:30)
#loc215 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":505:22)
#loc216 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":506:28)
#loc217 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":506:20)
#loc218 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":506:15)
#loc219 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":508:20)
#loc220 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":508:41)
#loc221 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":508:31)
#loc222 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":511:13)
#loc223 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":512:29)
#loc224 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":513:20)
#loc225 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":513:11)
#loc226 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":514:24)
#loc227 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":514:38)
#loc228 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":516:26)
#loc229 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":517:33)
#loc230 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":518:36)
#loc231 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":522:25)
#loc232 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":522:30)
#loc233 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":525:39)
#loc234 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":526:24)
#loc235 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":526:38)
#loc236 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":527:21)
#loc237 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":528:57)
#loc238 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":530:39)
#loc239 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":531:26)
#loc240 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":531:40)
#loc241 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":532:54)
#loc242 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":533:10)
#loc243 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":535:28)
#loc244 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":535:33)
#loc245 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":535:56)
#loc246 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":535:43)
#loc247 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":536:28)
#loc248 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":536:39)
#loc249 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":536:57)
#loc250 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":537:36)
#loc251 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":537:40)
#loc252 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":538:30)
#loc253 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":538:22)
#loc254 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":539:28)
#loc255 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":539:20)
#loc256 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":539:15)
#loc257 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":541:20)
#loc258 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":541:41)
#loc259 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":541:31)
#loc260 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":544:13)
#loc261 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":545:29)
#loc262 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":546:20)
#loc263 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":546:11)
#loc264 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":547:24)
#loc265 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":547:38)
#loc266 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":549:26)
#loc267 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":550:33)
#loc268 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":551:36)
#loc269 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":555:31)
#loc270 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":555:54)
#loc271 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":555:41)
#loc272 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":556:32)
#loc273 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:25)
#loc274 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:49)
#loc275 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:60)
#loc276 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:38)
#loc277 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:87)
#loc278 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:73)
#loc279 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:113)
#loc280 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":557:100)
#loc281 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":560:16)
#loc282 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":561:30)
#loc283 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":561:26)
#loc284 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":561:43)
#loc285 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":563:30)
#loc286 = loc("/home/dewwang/FlashMLA/benchmark/bench_flash_mla.v3.pipeline.py":563:4)
#loc287 = loc("/home/dewwang/triton/python/triton/experimental/gluon/language/_standard.py":29:0)
#loc288 = loc("/home/dewwang/triton/python/triton/experimental/gluon/language/_standard.py":41:38)
#loc289 = loc("/home/dewwang/triton/python/triton/experimental/gluon/language/_standard.py":41:11)
#loc290 = loc("/home/dewwang/triton/python/triton/experimental/gluon/language/_standard.py":41:4)
#loc292 = loc("/home/dewwang/triton/python/triton/language/standard.py":43:17)
#loc293 = loc("/home/dewwang/triton/python/triton/language/standard.py":43:30)
#loc294 = loc("/home/dewwang/triton/python/triton/language/standard.py":43:11)
#loc295 = loc("/home/dewwang/triton/python/triton/language/standard.py":43:4)
#loc297 = loc("/home/dewwang/triton/python/triton/language/standard.py":191:40)
#loc298 = loc("/home/dewwang/triton/python/triton/language/standard.py":191:15)
#loc299 = loc("/home/dewwang/triton/python/triton/language/standard.py":179:4)
#loc301 = loc("/home/dewwang/triton/python/triton/language/standard.py":170:27)
#loc302 = loc("/home/dewwang/triton/python/triton/language/standard.py":170:11)
#loc303 = loc("/home/dewwang/triton/python/triton/language/standard.py":170:4)
#loc305 = loc("/home/dewwang/triton/python/triton/language/standard.py":293:36)
#loc306 = loc("/home/dewwang/triton/python/triton/language/standard.py":293:11)
#loc307 = loc("/home/dewwang/triton/python/triton/language/standard.py":293:4)
#loc309 = loc("/home/dewwang/triton/python/triton/language/standard.py":263:15)
#loc310 = loc("/home/dewwang/triton/python/triton/language/standard.py":263:11)
#loc311 = loc("/home/dewwang/triton/python/triton/language/standard.py":263:4)
#loc330 = loc("cur_batch"(#loc2))
#loc331 = loc("cur_head_id"(#loc3))
#loc332 = loc("split_kv_id"(#loc4))
#loc333 = loc("cur_batch_seq_len"(#loc5))
#loc334 = loc("cur_batch_seq_len"(#loc6))
#loc335 = loc("buf_q_nope"(#loc7))
#loc336 = loc("buf_q_pe"(#loc8))
#loc337 = loc("bufs_kv"(#loc9))
#loc338 = loc("bufs_kpe"(#loc10))
#loc339 = loc("offs_d_ckv"(#loc11))
#loc340 = loc("cur_head"(#loc12))
#loc341 = loc("cur_head"(#loc13))
#loc342 = loc("cur_head"(#loc14))
#loc343 = loc("offs_q_nope"(#loc15))
#loc344 = loc("offs_q_nope"(#loc16))
#loc345 = loc("offs_q_nope"(#loc17))
#loc346 = loc("offs_q_nope"(#loc18))
#loc347 = loc("offs_q_nope"(#loc19))
#loc348 = loc("offs_q_nope"(#loc20))
#loc349 = loc("offs_d_kpe"(#loc23))
#loc350 = loc("cur_head_qpe"(#loc24))
#loc351 = loc("cur_head_qpe"(#loc25))
#loc352 = loc("cur_head_qpe"(#loc26))
#loc353 = loc("offs_q_pe"(#loc27))
#loc354 = loc("offs_q_pe"(#loc28))
#loc355 = loc("offs_q_pe"(#loc29))
#loc356 = loc("offs_q_pe"(#loc30))
#loc357 = loc("offs_q_pe"(#loc31))
#loc358 = loc("offs_q_pe"(#loc32))
#loc359 = loc("e_max"(#loc35))
#loc360 = loc("e_max"(#loc36))
#loc361 = loc("e_sum"(#loc37))
#loc362 = loc("acc"(#loc38))
#loc363 = loc("num_iter"(#loc39))
#loc364 = loc("start_n"(#loc40))
#loc365 = loc("kv_page_number"(#loc41))
#loc366 = loc("kv_page_number"(#loc42))
#loc367 = loc("kv_page_number"(#loc43))
#loc368 = loc("kv_page_number"(#loc44))
#loc369 = loc("kv_page_number"(#loc45))
#loc370 = loc("q_nope"(#loc47))
#loc371 = loc("q_pe"(#loc49))
#loc372 = loc("offs_n"(#loc50))
#loc373 = loc("offs_n"(#loc51))
#loc374 = loc("kv_loc"(#loc52))
#loc375 = loc("kv_loc"(#loc53))
#loc376 = loc("kv_loc"(#loc54))
#loc377 = loc("offs_d_ckv_1"(#loc55))
#loc378 = loc("offs_k_c"(#loc56))
#loc379 = loc("offs_k_c"(#loc57))
#loc380 = loc("offs_k_c"(#loc58))
#loc381 = loc("offs_k_c"(#loc59))
#loc382 = loc("offs_n_pe"(#loc63))
#loc383 = loc("offs_n_pe"(#loc64))
#loc384 = loc("kv_loc_pe"(#loc65))
#loc385 = loc("kv_loc_pe"(#loc66))
#loc386 = loc("kv_loc_pe"(#loc67))
#loc387 = loc("offs_d_kpe_1"(#loc68))
#loc388 = loc("offs_k_pe"(#loc69))
#loc389 = loc("offs_k_pe"(#loc70))
#loc390 = loc("offs_k_pe"(#loc71))
#loc391 = loc("offs_k_pe"(#loc72))
#loc392 = loc("start_n"(#loc76))
#loc393 = loc("kv_page_number"(#loc77))
#loc394 = loc("kv_page_number"(#loc78))
#loc395 = loc("kv_page_number"(#loc79))
#loc396 = loc("kv_page_number"(#loc80))
#loc397 = loc("kv_page_number"(#loc81))
#loc398 = loc("buf_idx"(#loc84))
#loc399 = loc("e_max"(#loc86))
#loc400 = loc("async_idx"(#loc87))
#loc401 = loc("async_idx"(#loc88))
#loc402 = loc("offs_n"(#loc89))
#loc403 = loc("offs_n"(#loc90))
#loc404 = loc("kv_loc"(#loc91))
#loc405 = loc("kv_loc"(#loc92))
#loc406 = loc("kv_loc"(#loc93))
#loc407 = loc("offs_d_ckv_1"(#loc94))
#loc408 = loc("offs_k_c"(#loc95))
#loc409 = loc("offs_k_c"(#loc96))
#loc410 = loc("offs_k_c"(#loc97))
#loc411 = loc("offs_k_c"(#loc98))
#loc412 = loc("offs_n_pe"(#loc104))
#loc413 = loc("offs_n_pe"(#loc105))
#loc414 = loc("kv_loc_pe"(#loc106))
#loc415 = loc("kv_loc_pe"(#loc107))
#loc416 = loc("kv_loc_pe"(#loc108))
#loc417 = loc("offs_d_kpe_1"(#loc109))
#loc418 = loc("offs_k_pe"(#loc110))
#loc419 = loc("offs_k_pe"(#loc111))
#loc420 = loc("offs_k_pe"(#loc112))
#loc421 = loc("offs_k_pe"(#loc113))
#loc422 = loc("start_n"(#loc119))
#loc423 = loc("kv_page_number"(#loc120))
#loc424 = loc("kv_page_number"(#loc121))
#loc425 = loc("kv_page_number"(#loc122))
#loc426 = loc("kv_page_number"(#loc123))
#loc427 = loc("kv_page_number"(#loc124))
#loc428 = loc("k_c"(#loc126))
#loc429 = loc("k_c"(#loc127))
#loc430 = loc("zeros"(#loc128))
#loc431 = loc("qk"(#loc129))
#loc432 = loc("k_pe"(#loc131))
#loc433 = loc("k_pe"(#loc132))
#loc434 = loc("qk"(#loc133))
#loc435 = loc("qk"(#loc134))
#loc436 = loc("offs_n_qk"(#loc135))
#loc437 = loc("offs_n_qk"(#loc136))
#loc438 = loc("offs_n_qk"(#loc137))
#loc439 = loc("qk"(#loc138))
#loc440 = loc("qk"(#loc139))
#loc441 = loc("qk"(#loc140))
#loc442 = loc("n_e_max"(#loc141))
#loc443 = loc("n_e_max"(#loc142))
#loc444 = loc("re_scale"(#loc143))
#loc445 = loc("re_scale"(#loc144))
#loc446 = loc("p"(#loc145))
#loc447 = loc("p"(#loc146))
#loc448 = loc("p"(#loc147))
#loc449 = loc("e_sum"(#loc148))
#loc450 = loc("e_sum"(#loc149))
#loc451 = loc("e_sum"(#loc150))
#loc452 = loc("p"(#loc151))
#loc453 = loc("p"(#loc152))
#loc454 = loc("acc"(#loc153))
#loc455 = loc("acc"(#loc154))
#loc456 = loc("v_c"(#loc155))
#loc457 = loc("v_c"(#loc156))
#loc458 = loc("v_c"(#loc157))
#loc459 = loc("v_c"(#loc158))
#loc460 = loc("acc"(#loc159))
#loc461 = loc("buf_idx"(#loc160))
#loc462 = loc("buf_idx"(#loc161))
#loc463 = loc("async_idx"(#loc163))
#loc464 = loc("async_idx"(#loc164))
#loc465 = loc("offs_n"(#loc165))
#loc466 = loc("offs_n"(#loc166))
#loc467 = loc("kv_loc"(#loc167))
#loc468 = loc("kv_loc"(#loc168))
#loc469 = loc("kv_loc"(#loc169))
#loc470 = loc("offs_d_ckv_1"(#loc170))
#loc471 = loc("offs_k_c"(#loc171))
#loc472 = loc("offs_k_c"(#loc172))
#loc473 = loc("offs_k_c"(#loc173))
#loc474 = loc("offs_k_c"(#loc174))
#loc475 = loc("offs_n_pe"(#loc180))
#loc476 = loc("offs_n_pe"(#loc181))
#loc477 = loc("kv_loc_pe"(#loc182))
#loc478 = loc("kv_loc_pe"(#loc183))
#loc479 = loc("kv_loc_pe"(#loc184))
#loc480 = loc("offs_d_kpe_1"(#loc185))
#loc481 = loc("offs_k_pe"(#loc186))
#loc482 = loc("offs_k_pe"(#loc187))
#loc483 = loc("offs_k_pe"(#loc188))
#loc484 = loc("offs_k_pe"(#loc189))
#loc485 = loc("k_c"(#loc196))
#loc486 = loc("k_c"(#loc197))
#loc487 = loc("zeros"(#loc198))
#loc488 = loc("qk"(#loc199))
#loc489 = loc("k_pe"(#loc201))
#loc490 = loc("k_pe"(#loc202))
#loc491 = loc("qk"(#loc203))
#loc492 = loc("qk"(#loc204))
#loc493 = loc("offs_n_qk"(#loc205))
#loc494 = loc("offs_n_qk"(#loc206))
#loc495 = loc("offs_n_qk"(#loc207))
#loc496 = loc("offs_n_qk"(#loc208))
#loc497 = loc("qk"(#loc209))
#loc498 = loc("qk"(#loc210))
#loc499 = loc("qk"(#loc211))
#loc500 = loc("n_e_max"(#loc212))
#loc501 = loc("n_e_max"(#loc213))
#loc502 = loc("re_scale"(#loc214))
#loc503 = loc("re_scale"(#loc215))
#loc504 = loc("p"(#loc216))
#loc505 = loc("p"(#loc217))
#loc506 = loc("p"(#loc218))
#loc507 = loc("e_sum"(#loc219))
#loc508 = loc("e_sum"(#loc220))
#loc509 = loc("e_sum"(#loc221))
#loc510 = loc("p"(#loc222))
#loc511 = loc("p"(#loc223))
#loc512 = loc("acc"(#loc224))
#loc513 = loc("acc"(#loc225))
#loc514 = loc("v_c"(#loc226))
#loc515 = loc("v_c"(#loc227))
#loc516 = loc("v_c"(#loc228))
#loc517 = loc("v_c"(#loc229))
#loc518 = loc("acc"(#loc230))
#loc519 = loc("buf_idx"(#loc231))
#loc520 = loc("buf_idx"(#loc232))
#loc521 = loc("k_c"(#loc234))
#loc522 = loc("k_c"(#loc235))
#loc523 = loc("zeros"(#loc236))
#loc524 = loc("qk"(#loc237))
#loc525 = loc("k_pe"(#loc239))
#loc526 = loc("k_pe"(#loc240))
#loc527 = loc("qk"(#loc241))
#loc528 = loc("qk"(#loc242))
#loc529 = loc("offs_n_qk"(#loc243))
#loc530 = loc("offs_n_qk"(#loc244))
#loc531 = loc("offs_n_qk"(#loc245))
#loc532 = loc("offs_n_qk"(#loc246))
#loc533 = loc("qk"(#loc247))
#loc534 = loc("qk"(#loc248))
#loc535 = loc("qk"(#loc249))
#loc536 = loc("n_e_max"(#loc250))
#loc537 = loc("n_e_max"(#loc251))
#loc538 = loc("re_scale"(#loc252))
#loc539 = loc("re_scale"(#loc253))
#loc540 = loc("p"(#loc254))
#loc541 = loc("p"(#loc255))
#loc542 = loc("p"(#loc256))
#loc543 = loc("e_sum"(#loc257))
#loc544 = loc("e_sum"(#loc258))
#loc545 = loc("e_sum"(#loc259))
#loc546 = loc("p"(#loc260))
#loc547 = loc("p"(#loc261))
#loc548 = loc("acc"(#loc262))
#loc549 = loc("acc"(#loc263))
#loc550 = loc("v_c"(#loc264))
#loc551 = loc("v_c"(#loc265))
#loc552 = loc("v_c"(#loc266))
#loc553 = loc("v_c"(#loc267))
#loc554 = loc("acc"(#loc268))
#loc555 = loc("cur_head_o"(#loc269))
#loc556 = loc("cur_head_o"(#loc270))
#loc557 = loc("cur_head_o"(#loc271))
#loc558 = loc("offs_d_ckv_o"(#loc272))
#loc559 = loc("offs_o"(#loc273))
#loc560 = loc("offs_o"(#loc274))
#loc561 = loc("offs_o"(#loc275))
#loc562 = loc("offs_o"(#loc276))
#loc563 = loc("offs_o"(#loc277))
#loc564 = loc("offs_o"(#loc278))
#loc565 = loc("offs_o"(#loc279))
#loc566 = loc("offs_o"(#loc280))
#loc567 = loc("rcp"(#loc281))
#loc568 = loc("stored_value"(#loc282))
#loc569 = loc("stored_value"(#loc283))
#loc570 = loc("stored_value"(#loc284))
#loc578 = loc("e_sum"(#loc399))
#loc579 = loc("acc"(#loc578))
#loc580 = loc("start_n"(#loc579))
#loc581 = loc("kv_page_number"(#loc580))
#loc582 = loc("offs_n"(#loc581))
#loc583 = loc("kv_loc"(#loc582))
#loc584 = loc("offs_d_ckv_1"(#loc583))
#loc585 = loc("offs_k_c"(#loc584))
#loc586 = loc("offs_n_pe"(#loc585))
#loc587 = loc("kv_loc_pe"(#loc586))
#loc588 = loc("offs_d_kpe_1"(#loc587))
#loc589 = loc("offs_k_pe"(#loc588))
#loc590 = loc("buf_idx"(#loc589))
